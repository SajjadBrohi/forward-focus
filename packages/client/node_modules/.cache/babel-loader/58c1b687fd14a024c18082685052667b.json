{"ast":null,"code":"\"use strict\";\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Page = void 0;\n\nconst fs = __importStar(require(\"fs\"));\n\nconst util_1 = require(\"util\");\n\nconst EventEmitter_js_1 = require(\"./EventEmitter.js\");\n\nconst mime = __importStar(require(\"mime\"));\n\nconst Connection_js_1 = require(\"./Connection.js\");\n\nconst Dialog_js_1 = require(\"./Dialog.js\");\n\nconst EmulationManager_js_1 = require(\"./EmulationManager.js\");\n\nconst FrameManager_js_1 = require(\"./FrameManager.js\");\n\nconst Input_js_1 = require(\"./Input.js\");\n\nconst Tracing_js_1 = require(\"./Tracing.js\");\n\nconst assert_js_1 = require(\"./assert.js\");\n\nconst helper_js_1 = require(\"./helper.js\");\n\nconst Coverage_js_1 = require(\"./Coverage.js\");\n\nconst WebWorker_js_1 = require(\"./WebWorker.js\");\n\nconst JSHandle_js_1 = require(\"./JSHandle.js\");\n\nconst NetworkManager_js_1 = require(\"./NetworkManager.js\");\n\nconst Accessibility_js_1 = require(\"./Accessibility.js\");\n\nconst TimeoutSettings_js_1 = require(\"./TimeoutSettings.js\");\n\nconst FileChooser_js_1 = require(\"./FileChooser.js\");\n\nconst ConsoleMessage_js_1 = require(\"./ConsoleMessage.js\");\n\nconst PDFOptions_js_1 = require(\"./PDFOptions.js\");\n\nconst writeFileAsync = util_1.promisify(fs.writeFile);\n\nclass ScreenshotTaskQueue {\n  constructor() {\n    this._chain = Promise.resolve(undefined);\n  }\n\n  postTask(task) {\n    const result = this._chain.then(task);\n\n    this._chain = result.catch(() => {});\n    return result;\n  }\n\n}\n/**\n * Page provides methods to interact with a single tab or\n * {@link https://developer.chrome.com/extensions/background_pages | extension background page} in Chromium.\n *\n * @remarks\n *\n * One Browser instance might have multiple Page instances.\n *\n * @example\n * This example creates a page, navigates it to a URL, and then * saves a screenshot:\n * ```js\n * const puppeteer = require('puppeteer');\n *\n * (async () => {\n *   const browser = await puppeteer.launch();\n *   const page = await browser.newPage();\n *   await page.goto('https://example.com');\n *   await page.screenshot({path: 'screenshot.png'});\n *   await browser.close();\n * })();\n * ```\n *\n * The Page class extends from Puppeteer's {@link EventEmitter} class and will\n * emit various events which are documented in the {@link PageEmittedEvents} enum.\n *\n * @example\n * This example logs a message for a single page `load` event:\n * ```js\n * page.once('load', () => console.log('Page loaded!'));\n * ```\n *\n * To unsubscribe from events use the `off` method:\n *\n * ```js\n * function logRequest(interceptedRequest) {\n *   console.log('A request was made:', interceptedRequest.url());\n * }\n * page.on('request', logRequest);\n * // Sometime later...\n * page.off('request', logRequest);\n * ```\n * @public\n */\n\n\nclass Page extends EventEmitter_js_1.EventEmitter {\n  /**\n   * @internal\n   */\n  constructor(client, target, ignoreHTTPSErrors) {\n    super();\n    this._closed = false;\n    this._timeoutSettings = new TimeoutSettings_js_1.TimeoutSettings();\n    this._pageBindings = new Map();\n    this._javascriptEnabled = true;\n    this._workers = new Map(); // TODO: improve this typedef - it's a function that takes a file chooser or\n    // something?\n\n    this._fileChooserInterceptors = new Set();\n    this._client = client;\n    this._target = target;\n    this._keyboard = new Input_js_1.Keyboard(client);\n    this._mouse = new Input_js_1.Mouse(client, this._keyboard);\n    this._touchscreen = new Input_js_1.Touchscreen(client, this._keyboard);\n    this._accessibility = new Accessibility_js_1.Accessibility(client);\n    this._frameManager = new FrameManager_js_1.FrameManager(client, this, ignoreHTTPSErrors, this._timeoutSettings);\n    this._emulationManager = new EmulationManager_js_1.EmulationManager(client);\n    this._tracing = new Tracing_js_1.Tracing(client);\n    this._coverage = new Coverage_js_1.Coverage(client);\n    this._screenshotTaskQueue = new ScreenshotTaskQueue();\n    this._viewport = null;\n    client.on('Target.attachedToTarget', event => {\n      if (event.targetInfo.type !== 'worker') {\n        // If we don't detach from service workers, they will never die.\n        client.send('Target.detachFromTarget', {\n          sessionId: event.sessionId\n        }).catch(helper_js_1.debugError);\n        return;\n      }\n\n      const session = Connection_js_1.Connection.fromSession(client).session(event.sessionId);\n      const worker = new WebWorker_js_1.WebWorker(session, event.targetInfo.url, this._addConsoleMessage.bind(this), this._handleException.bind(this));\n\n      this._workers.set(event.sessionId, worker);\n\n      this.emit(\"workercreated\"\n      /* WorkerCreated */\n      , worker);\n    });\n    client.on('Target.detachedFromTarget', event => {\n      const worker = this._workers.get(event.sessionId);\n\n      if (!worker) return;\n      this.emit(\"workerdestroyed\"\n      /* WorkerDestroyed */\n      , worker);\n\n      this._workers.delete(event.sessionId);\n    });\n\n    this._frameManager.on(FrameManager_js_1.FrameManagerEmittedEvents.FrameAttached, event => this.emit(\"frameattached\"\n    /* FrameAttached */\n    , event));\n\n    this._frameManager.on(FrameManager_js_1.FrameManagerEmittedEvents.FrameDetached, event => this.emit(\"framedetached\"\n    /* FrameDetached */\n    , event));\n\n    this._frameManager.on(FrameManager_js_1.FrameManagerEmittedEvents.FrameNavigated, event => this.emit(\"framenavigated\"\n    /* FrameNavigated */\n    , event));\n\n    const networkManager = this._frameManager.networkManager();\n\n    networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.Request, event => this.emit(\"request\"\n    /* Request */\n    , event));\n    networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.Response, event => this.emit(\"response\"\n    /* Response */\n    , event));\n    networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.RequestFailed, event => this.emit(\"requestfailed\"\n    /* RequestFailed */\n    , event));\n    networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.RequestFinished, event => this.emit(\"requestfinished\"\n    /* RequestFinished */\n    , event));\n    this._fileChooserInterceptors = new Set();\n    client.on('Page.domContentEventFired', () => this.emit(\"domcontentloaded\"\n    /* DOMContentLoaded */\n    ));\n    client.on('Page.loadEventFired', () => this.emit(\"load\"\n    /* Load */\n    ));\n    client.on('Runtime.consoleAPICalled', event => this._onConsoleAPI(event));\n    client.on('Runtime.bindingCalled', event => this._onBindingCalled(event));\n    client.on('Page.javascriptDialogOpening', event => this._onDialog(event));\n    client.on('Runtime.exceptionThrown', exception => this._handleException(exception.exceptionDetails));\n    client.on('Inspector.targetCrashed', () => this._onTargetCrashed());\n    client.on('Performance.metrics', event => this._emitMetrics(event));\n    client.on('Log.entryAdded', event => this._onLogEntryAdded(event));\n    client.on('Page.fileChooserOpened', event => this._onFileChooser(event));\n\n    this._target._isClosedPromise.then(() => {\n      this.emit(\"close\"\n      /* Close */\n      );\n      this._closed = true;\n    });\n  }\n  /**\n   * @internal\n   */\n\n\n  static async create(client, target, ignoreHTTPSErrors, defaultViewport) {\n    const page = new Page(client, target, ignoreHTTPSErrors);\n    await page._initialize();\n    if (defaultViewport) await page.setViewport(defaultViewport);\n    return page;\n  }\n\n  async _initialize() {\n    await Promise.all([this._frameManager.initialize(), this._client.send('Target.setAutoAttach', {\n      autoAttach: true,\n      waitForDebuggerOnStart: false,\n      flatten: true\n    }), this._client.send('Performance.enable'), this._client.send('Log.enable')]);\n  }\n\n  async _onFileChooser(event) {\n    if (!this._fileChooserInterceptors.size) return;\n\n    const frame = this._frameManager.frame(event.frameId);\n\n    const context = await frame.executionContext();\n    const element = await context._adoptBackendNodeId(event.backendNodeId);\n    const interceptors = Array.from(this._fileChooserInterceptors);\n\n    this._fileChooserInterceptors.clear();\n\n    const fileChooser = new FileChooser_js_1.FileChooser(element, event);\n\n    for (const interceptor of interceptors) interceptor.call(null, fileChooser);\n  }\n  /**\n   * @returns `true` if the page has JavaScript enabled, `false` otherwise.\n   */\n\n\n  isJavaScriptEnabled() {\n    return this._javascriptEnabled;\n  }\n  /**\n   * @param options - Optional waiting parameters\n   * @returns Resolves after a page requests a file picker.\n   */\n\n\n  async waitForFileChooser(options = {}) {\n    if (!this._fileChooserInterceptors.size) await this._client.send('Page.setInterceptFileChooserDialog', {\n      enabled: true\n    });\n    const {\n      timeout = this._timeoutSettings.timeout()\n    } = options;\n    let callback;\n    const promise = new Promise(x => callback = x);\n\n    this._fileChooserInterceptors.add(callback);\n\n    return helper_js_1.helper.waitWithTimeout(promise, 'waiting for file chooser', timeout).catch(error => {\n      this._fileChooserInterceptors.delete(callback);\n\n      throw error;\n    });\n  }\n  /**\n   * Sets the page's geolocation.\n   *\n   * @remarks\n   * Consider using {@link BrowserContext.overridePermissions} to grant\n   * permissions for the page to read its geolocation.\n   *\n   * @example\n   * ```js\n   * await page.setGeolocation({latitude: 59.95, longitude: 30.31667});\n   * ```\n   */\n\n\n  async setGeolocation(options) {\n    const {\n      longitude,\n      latitude,\n      accuracy = 0\n    } = options;\n    if (longitude < -180 || longitude > 180) throw new Error(`Invalid longitude \"${longitude}\": precondition -180 <= LONGITUDE <= 180 failed.`);\n    if (latitude < -90 || latitude > 90) throw new Error(`Invalid latitude \"${latitude}\": precondition -90 <= LATITUDE <= 90 failed.`);\n    if (accuracy < 0) throw new Error(`Invalid accuracy \"${accuracy}\": precondition 0 <= ACCURACY failed.`);\n    await this._client.send('Emulation.setGeolocationOverride', {\n      longitude,\n      latitude,\n      accuracy\n    });\n  }\n  /**\n   * @returns A target this page was created from.\n   */\n\n\n  target() {\n    return this._target;\n  }\n  /**\n   * @returns The browser this page belongs to.\n   */\n\n\n  browser() {\n    return this._target.browser();\n  }\n  /**\n   * @returns The browser context that the page belongs to\n   */\n\n\n  browserContext() {\n    return this._target.browserContext();\n  }\n\n  _onTargetCrashed() {\n    this.emit('error', new Error('Page crashed!'));\n  }\n\n  _onLogEntryAdded(event) {\n    const {\n      level,\n      text,\n      args,\n      source,\n      url,\n      lineNumber\n    } = event.entry;\n    if (args) args.map(arg => helper_js_1.helper.releaseObject(this._client, arg));\n    if (source !== 'worker') this.emit(\"console\"\n    /* Console */\n    , new ConsoleMessage_js_1.ConsoleMessage(level, text, [], {\n      url,\n      lineNumber\n    }));\n  }\n  /**\n   * @returns The page's main frame.\n   */\n\n\n  mainFrame() {\n    return this._frameManager.mainFrame();\n  }\n\n  get keyboard() {\n    return this._keyboard;\n  }\n\n  get touchscreen() {\n    return this._touchscreen;\n  }\n\n  get coverage() {\n    return this._coverage;\n  }\n\n  get tracing() {\n    return this._tracing;\n  }\n\n  get accessibility() {\n    return this._accessibility;\n  }\n  /**\n   * @returns An array of all frames attached to the page.\n   */\n\n\n  frames() {\n    return this._frameManager.frames();\n  }\n  /**\n   * @returns all of the dedicated\n   * {@link https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API | WebWorkers}\n   * associated with the page.\n   */\n\n\n  workers() {\n    return Array.from(this._workers.values());\n  }\n  /**\n   * @param value - Whether to enable request interception.\n   *\n   * @remarks\n   * Activating request interception enables {@link HTTPRequest.abort},\n   * {@link HTTPRequest.continue} and {@link HTTPRequest.respond} methods.  This\n   * provides the capability to modify network requests that are made by a page.\n   *\n   * Once request interception is enabled, every request will stall unless it's\n   * continued, responded or aborted.\n   *\n   * **NOTE** Enabling request interception disables page caching.\n   *\n   * @example\n   * An example of a naïve request interceptor that aborts all image requests:\n   * ```js\n   * const puppeteer = require('puppeteer');\n   * (async () => {\n   *   const browser = await puppeteer.launch();\n   *   const page = await browser.newPage();\n   *   await page.setRequestInterception(true);\n   *   page.on('request', interceptedRequest => {\n   *     if (interceptedRequest.url().endsWith('.png') ||\n   *         interceptedRequest.url().endsWith('.jpg'))\n   *       interceptedRequest.abort();\n   *     else\n   *       interceptedRequest.continue();\n   *     });\n   *   await page.goto('https://example.com');\n   *   await browser.close();\n   * })();\n   * ```\n   */\n\n\n  async setRequestInterception(value) {\n    return this._frameManager.networkManager().setRequestInterception(value);\n  }\n  /**\n   * @param enabled - When `true`, enables offline mode for the page.\n   */\n\n\n  setOfflineMode(enabled) {\n    return this._frameManager.networkManager().setOfflineMode(enabled);\n  }\n  /**\n   * @param timeout - Maximum navigation time in milliseconds.\n   */\n\n\n  setDefaultNavigationTimeout(timeout) {\n    this._timeoutSettings.setDefaultNavigationTimeout(timeout);\n  }\n  /**\n   * @param timeout - Maximum time in milliseconds.\n   */\n\n\n  setDefaultTimeout(timeout) {\n    this._timeoutSettings.setDefaultTimeout(timeout);\n  }\n  /**\n   * Runs `document.querySelector` within the page. If no element matches the\n   * selector, the return value resolves to `null`.\n   *\n   * @remarks\n   * Shortcut for {@link Frame.$ | Page.mainFrame().$(selector) }.\n   *\n   * @param selector - A\n   * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors | selector}\n   * to query page for.\n   */\n\n\n  async $(selector) {\n    return this.mainFrame().$(selector);\n  }\n  /**\n   * @remarks\n   *\n   * The only difference between {@link Page.evaluate | page.evaluate} and\n   * `page.evaluateHandle` is that `evaluateHandle` will return the value\n   * wrapped in an in-page object.\n   *\n   * If the function passed to `page.evaluteHandle` returns a Promise, the\n   * function will wait for the promise to resolve and return its value.\n   *\n   * You can pass a string instead of a function (although functions are\n   * recommended as they are easier to debug and use with TypeScript):\n   *\n   * @example\n   * ```\n   * const aHandle = await page.evaluateHandle('document')\n   * ```\n   *\n   * @example\n   * {@link JSHandle} instances can be passed as arguments to the `pageFunction`:\n   * ```\n   * const aHandle = await page.evaluateHandle(() => document.body);\n   * const resultHandle = await page.evaluateHandle(body => body.innerHTML, aHandle);\n   * console.log(await resultHandle.jsonValue());\n   * await resultHandle.dispose();\n   * ```\n   *\n   * Most of the time this function returns a {@link JSHandle},\n   * but if `pageFunction` returns a reference to an element,\n   * you instead get an {@link ElementHandle} back:\n   *\n   * @example\n   * ```\n   * const button = await page.evaluateHandle(() => document.querySelector('button'));\n   * // can call `click` because `button` is an `ElementHandle`\n   * await button.click();\n   * ```\n   *\n   * The TypeScript definitions assume that `evaluateHandle` returns\n   *  a `JSHandle`, but if you know it's going to return an\n   * `ElementHandle`, pass it as the generic argument:\n   *\n   * ```\n   * const button = await page.evaluateHandle<ElementHandle>(...);\n   * ```\n   *\n   * @param pageFunction - a function that is run within the page\n   * @param args - arguments to be passed to the pageFunction\n   */\n\n\n  async evaluateHandle(pageFunction, ...args) {\n    const context = await this.mainFrame().executionContext();\n    return context.evaluateHandle(pageFunction, ...args);\n  }\n  /**\n   * This method iterates the JavaScript heap and finds all objects with the\n   * given prototype.\n   *\n   * @remarks\n   *\n   * @example\n   *\n   * ```js\n   * // Create a Map object\n   * await page.evaluate(() => window.map = new Map());\n   * // Get a handle to the Map object prototype\n   * const mapPrototype = await page.evaluateHandle(() => Map.prototype);\n   * // Query all map instances into an array\n   * const mapInstances = await page.queryObjects(mapPrototype);\n   * // Count amount of map objects in heap\n   * const count = await page.evaluate(maps => maps.length, mapInstances);\n   * await mapInstances.dispose();\n   * await mapPrototype.dispose();\n   * ```\n   * @param prototypeHandle - a handle to the object prototype.\n   */\n\n\n  async queryObjects(prototypeHandle) {\n    const context = await this.mainFrame().executionContext();\n    return context.queryObjects(prototypeHandle);\n  }\n  /**\n   * This method runs `document.querySelector` within the page and passes the\n   * result as the first argument to the `pageFunction`.\n   *\n   * @remarks\n   *\n   * If no element is found matching `selector`, the method will throw an error.\n   *\n   * If `pageFunction` returns a promise `$eval` will wait for the promise to\n   * resolve and then return its value.\n   *\n   * @example\n   *\n   * ```\n   * const searchValue = await page.$eval('#search', el => el.value);\n   * const preloadHref = await page.$eval('link[rel=preload]', el => el.href);\n   * const html = await page.$eval('.main-container', el => el.outerHTML);\n   * ```\n   *\n   * If you are using TypeScript, you may have to provide an explicit type to the\n   * first argument of the `pageFunction`.\n   * By default it is typed as `Element`, but you may need to provide a more\n   * specific sub-type:\n   *\n   * @example\n   *\n   * ```\n   * // if you don't provide HTMLInputElement here, TS will error\n   * // as `value` is not on `Element`\n   * const searchValue = await page.$eval('#search', (el: HTMLInputElement) => el.value);\n   * ```\n   *\n   * The compiler should be able to infer the return type\n   * from the `pageFunction` you provide. If it is unable to, you can use the generic\n   * type to tell the compiler what return type you expect from `$eval`:\n   *\n   * @example\n   *\n   * ```\n   * // The compiler can infer the return type in this case, but if it can't\n   * // or if you want to be more explicit, provide it as the generic type.\n   * const searchValue = await page.$eval<string>(\n   *  '#search', (el: HTMLInputElement) => el.value\n   * );\n   * ```\n   *\n   * @param selector - the\n   * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors | selector}\n   * to query for\n   * @param pageFunction - the function to be evaluated in the page context.\n   * Will be passed the result of `document.querySelector(selector)` as its\n   * first argument.\n   * @param args - any additional arguments to pass through to `pageFunction`.\n   *\n   * @returns The result of calling `pageFunction`. If it returns an element it\n   * is wrapped in an {@link ElementHandle}, else the raw value itself is\n   * returned.\n   */\n\n\n  async $eval(selector, pageFunction, ...args) {\n    return this.mainFrame().$eval(selector, pageFunction, ...args);\n  }\n  /**\n   * This method runs `Array.from(document.querySelectorAll(selector))` within\n   * the page and passes the result as the first argument to the `pageFunction`.\n   *\n   * @remarks\n   *\n   * If `pageFunction` returns a promise `$$eval` will wait for the promise to\n   * resolve and then return its value.\n   *\n   * @example\n   *\n   * ```\n   * // get the amount of divs on the page\n   * const divCount = await page.$$eval('div', divs => divs.length);\n   *\n   * // get the text content of all the `.options` elements:\n   * const options = await page.$$eval('div > span.options', options => {\n   *   return options.map(option => option.textContent)\n   * });\n   * ```\n   *\n   * If you are using TypeScript, you may have to provide an explicit type to the\n   * first argument of the `pageFunction`.\n   * By default it is typed as `Element[]`, but you may need to provide a more\n   * specific sub-type:\n   *\n   * @example\n   *\n   * ```\n   * // if you don't provide HTMLInputElement here, TS will error\n   * // as `value` is not on `Element`\n   * await page.$$eval('input', (elements: HTMLInputElement[]) => {\n   *   return elements.map(e => e.value);\n   * });\n   * ```\n   *\n   * The compiler should be able to infer the return type\n   * from the `pageFunction` you provide. If it is unable to, you can use the generic\n   * type to tell the compiler what return type you expect from `$$eval`:\n   *\n   * @example\n   *\n   * ```\n   * // The compiler can infer the return type in this case, but if it can't\n   * // or if you want to be more explicit, provide it as the generic type.\n   * const allInputValues = await page.$$eval<string[]>(\n   *  'input', (elements: HTMLInputElement[]) => elements.map(e => e.textContent)\n   * );\n   * ```\n   *\n   * @param selector the\n   * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors | selector}\n   * to query for\n   * @param pageFunction the function to be evaluated in the page context. Will\n   * be passed the result of `Array.from(document.querySelectorAll(selector))`\n   * as its first argument.\n   * @param args any additional arguments to pass through to `pageFunction`.\n   *\n   * @returns The result of calling `pageFunction`. If it returns an element it\n   * is wrapped in an {@link ElementHandle}, else the raw value itself is\n   * returned.\n   */\n\n\n  async $$eval(selector, pageFunction, ...args) {\n    return this.mainFrame().$$eval(selector, pageFunction, ...args);\n  }\n\n  async $$(selector) {\n    return this.mainFrame().$$(selector);\n  }\n\n  async $x(expression) {\n    return this.mainFrame().$x(expression);\n  }\n  /**\n   * If no URLs are specified, this method returns cookies for the current page\n   * URL. If URLs are specified, only cookies for those URLs are returned.\n   */\n\n\n  async cookies(...urls) {\n    const originalCookies = (await this._client.send('Network.getCookies', {\n      urls: urls.length ? urls : [this.url()]\n    })).cookies;\n    const unsupportedCookieAttributes = ['priority'];\n\n    const filterUnsupportedAttributes = cookie => {\n      for (const attr of unsupportedCookieAttributes) delete cookie[attr];\n\n      return cookie;\n    };\n\n    return originalCookies.map(filterUnsupportedAttributes);\n  }\n\n  async deleteCookie(...cookies) {\n    const pageURL = this.url();\n\n    for (const cookie of cookies) {\n      const item = Object.assign({}, cookie);\n      if (!cookie.url && pageURL.startsWith('http')) item.url = pageURL;\n      await this._client.send('Network.deleteCookies', item);\n    }\n  }\n\n  async setCookie(...cookies) {\n    const pageURL = this.url();\n    const startsWithHTTP = pageURL.startsWith('http');\n    const items = cookies.map(cookie => {\n      const item = Object.assign({}, cookie);\n      if (!item.url && startsWithHTTP) item.url = pageURL;\n      assert_js_1.assert(item.url !== 'about:blank', `Blank page can not have cookie \"${item.name}\"`);\n      assert_js_1.assert(!String.prototype.startsWith.call(item.url || '', 'data:'), `Data URL page can not have cookie \"${item.name}\"`);\n      return item;\n    });\n    await this.deleteCookie(...items);\n    if (items.length) await this._client.send('Network.setCookies', {\n      cookies: items\n    });\n  }\n\n  async addScriptTag(options) {\n    return this.mainFrame().addScriptTag(options);\n  }\n\n  async addStyleTag(options) {\n    return this.mainFrame().addStyleTag(options);\n  }\n\n  async exposeFunction(name, puppeteerFunction) {\n    if (this._pageBindings.has(name)) throw new Error(`Failed to add page binding with name ${name}: window['${name}'] already exists!`);\n\n    this._pageBindings.set(name, puppeteerFunction);\n\n    const expression = helper_js_1.helper.evaluationString(addPageBinding, name);\n    await this._client.send('Runtime.addBinding', {\n      name: name\n    });\n    await this._client.send('Page.addScriptToEvaluateOnNewDocument', {\n      source: expression\n    });\n    await Promise.all(this.frames().map(frame => frame.evaluate(expression).catch(helper_js_1.debugError)));\n\n    function addPageBinding(bindingName) {\n      /* Cast window to any here as we're about to add properties to it\n       * via win[bindingName] which TypeScript doesn't like.\n       */\n      const win = window;\n      const binding = win[bindingName];\n\n      win[bindingName] = (...args) => {\n        const me = window[bindingName];\n        let callbacks = me['callbacks'];\n\n        if (!callbacks) {\n          callbacks = new Map();\n          me['callbacks'] = callbacks;\n        }\n\n        const seq = (me['lastSeq'] || 0) + 1;\n        me['lastSeq'] = seq;\n        const promise = new Promise((resolve, reject) => callbacks.set(seq, {\n          resolve,\n          reject\n        }));\n        binding(JSON.stringify({\n          name: bindingName,\n          seq,\n          args\n        }));\n        return promise;\n      };\n    }\n  }\n\n  async authenticate(credentials) {\n    return this._frameManager.networkManager().authenticate(credentials);\n  }\n\n  async setExtraHTTPHeaders(headers) {\n    return this._frameManager.networkManager().setExtraHTTPHeaders(headers);\n  }\n\n  async setUserAgent(userAgent) {\n    return this._frameManager.networkManager().setUserAgent(userAgent);\n  }\n\n  async metrics() {\n    const response = await this._client.send('Performance.getMetrics');\n    return this._buildMetricsObject(response.metrics);\n  }\n\n  _emitMetrics(event) {\n    this.emit(\"metrics\"\n    /* Metrics */\n    , {\n      title: event.title,\n      metrics: this._buildMetricsObject(event.metrics)\n    });\n  }\n\n  _buildMetricsObject(metrics) {\n    const result = {};\n\n    for (const metric of metrics || []) {\n      if (supportedMetrics.has(metric.name)) result[metric.name] = metric.value;\n    }\n\n    return result;\n  }\n\n  _handleException(exceptionDetails) {\n    const message = helper_js_1.helper.getExceptionMessage(exceptionDetails);\n    const err = new Error(message);\n    err.stack = ''; // Don't report clientside error with a node stack attached\n\n    this.emit(\"pageerror\"\n    /* PageError */\n    , err);\n  }\n\n  async _onConsoleAPI(event) {\n    if (event.executionContextId === 0) {\n      // DevTools protocol stores the last 1000 console messages. These\n      // messages are always reported even for removed execution contexts. In\n      // this case, they are marked with executionContextId = 0 and are\n      // reported upon enabling Runtime agent.\n      //\n      // Ignore these messages since:\n      // - there's no execution context we can use to operate with message\n      //   arguments\n      // - these messages are reported before Puppeteer clients can subscribe\n      //   to the 'console'\n      //   page event.\n      //\n      // @see https://github.com/puppeteer/puppeteer/issues/3865\n      return;\n    }\n\n    const context = this._frameManager.executionContextById(event.executionContextId);\n\n    const values = event.args.map(arg => JSHandle_js_1.createJSHandle(context, arg));\n\n    this._addConsoleMessage(event.type, values, event.stackTrace);\n  }\n\n  async _onBindingCalled(event) {\n    const {\n      name,\n      seq,\n      args\n    } = JSON.parse(event.payload);\n    let expression = null;\n\n    try {\n      const result = await this._pageBindings.get(name)(...args);\n      expression = helper_js_1.helper.evaluationString(deliverResult, name, seq, result);\n    } catch (error) {\n      if (error instanceof Error) expression = helper_js_1.helper.evaluationString(deliverError, name, seq, error.message, error.stack);else expression = helper_js_1.helper.evaluationString(deliverErrorValue, name, seq, error);\n    }\n\n    this._client.send('Runtime.evaluate', {\n      expression,\n      contextId: event.executionContextId\n    }).catch(helper_js_1.debugError);\n\n    function deliverResult(name, seq, result) {\n      window[name]['callbacks'].get(seq).resolve(result);\n      window[name]['callbacks'].delete(seq);\n    }\n\n    function deliverError(name, seq, message, stack) {\n      const error = new Error(message);\n      error.stack = stack;\n      window[name]['callbacks'].get(seq).reject(error);\n      window[name]['callbacks'].delete(seq);\n    }\n\n    function deliverErrorValue(name, seq, value) {\n      window[name]['callbacks'].get(seq).reject(value);\n      window[name]['callbacks'].delete(seq);\n    }\n  }\n\n  _addConsoleMessage(type, args, stackTrace) {\n    if (!this.listenerCount(\"console\"\n    /* Console */\n    )) {\n      args.forEach(arg => arg.dispose());\n      return;\n    }\n\n    const textTokens = [];\n\n    for (const arg of args) {\n      const remoteObject = arg._remoteObject;\n      if (remoteObject.objectId) textTokens.push(arg.toString());else textTokens.push(helper_js_1.helper.valueFromRemoteObject(remoteObject));\n    }\n\n    const location = stackTrace && stackTrace.callFrames.length ? {\n      url: stackTrace.callFrames[0].url,\n      lineNumber: stackTrace.callFrames[0].lineNumber,\n      columnNumber: stackTrace.callFrames[0].columnNumber\n    } : {};\n    const message = new ConsoleMessage_js_1.ConsoleMessage(type, textTokens.join(' '), args, location);\n    this.emit(\"console\"\n    /* Console */\n    , message);\n  }\n\n  _onDialog(event) {\n    let dialogType = null;\n    const validDialogTypes = new Set(['alert', 'confirm', 'prompt', 'beforeunload']);\n\n    if (validDialogTypes.has(event.type)) {\n      dialogType = event.type;\n    }\n\n    assert_js_1.assert(dialogType, 'Unknown javascript dialog type: ' + event.type);\n    const dialog = new Dialog_js_1.Dialog(this._client, dialogType, event.message, event.defaultPrompt);\n    this.emit(\"dialog\"\n    /* Dialog */\n    , dialog);\n  }\n\n  url() {\n    return this.mainFrame().url();\n  }\n\n  async content() {\n    return await this._frameManager.mainFrame().content();\n  }\n\n  async setContent(html, options = {}) {\n    await this._frameManager.mainFrame().setContent(html, options);\n  }\n\n  async goto(url, options = {}) {\n    return await this._frameManager.mainFrame().goto(url, options);\n  }\n\n  async reload(options) {\n    const result = await Promise.all([this.waitForNavigation(options), this._client.send('Page.reload')]);\n    return result[0];\n  }\n\n  async waitForNavigation(options = {}) {\n    return await this._frameManager.mainFrame().waitForNavigation(options);\n  }\n\n  _sessionClosePromise() {\n    if (!this._disconnectPromise) this._disconnectPromise = new Promise(fulfill => this._client.once(Connection_js_1.CDPSessionEmittedEvents.Disconnected, () => fulfill(new Error('Target closed'))));\n    return this._disconnectPromise;\n  }\n\n  async waitForRequest(urlOrPredicate, options = {}) {\n    const {\n      timeout = this._timeoutSettings.timeout()\n    } = options;\n    return helper_js_1.helper.waitForEvent(this._frameManager.networkManager(), NetworkManager_js_1.NetworkManagerEmittedEvents.Request, request => {\n      if (helper_js_1.helper.isString(urlOrPredicate)) return urlOrPredicate === request.url();\n      if (typeof urlOrPredicate === 'function') return !!urlOrPredicate(request);\n      return false;\n    }, timeout, this._sessionClosePromise());\n  }\n\n  async waitForResponse(urlOrPredicate, options = {}) {\n    const {\n      timeout = this._timeoutSettings.timeout()\n    } = options;\n    return helper_js_1.helper.waitForEvent(this._frameManager.networkManager(), NetworkManager_js_1.NetworkManagerEmittedEvents.Response, response => {\n      if (helper_js_1.helper.isString(urlOrPredicate)) return urlOrPredicate === response.url();\n      if (typeof urlOrPredicate === 'function') return !!urlOrPredicate(response);\n      return false;\n    }, timeout, this._sessionClosePromise());\n  }\n\n  async goBack(options = {}) {\n    return this._go(-1, options);\n  }\n\n  async goForward(options = {}) {\n    return this._go(+1, options);\n  }\n\n  async _go(delta, options) {\n    const history = await this._client.send('Page.getNavigationHistory');\n    const entry = history.entries[history.currentIndex + delta];\n    if (!entry) return null;\n    const result = await Promise.all([this.waitForNavigation(options), this._client.send('Page.navigateToHistoryEntry', {\n      entryId: entry.id\n    })]);\n    return result[0];\n  }\n\n  async bringToFront() {\n    await this._client.send('Page.bringToFront');\n  }\n\n  async emulate(options) {\n    await Promise.all([this.setViewport(options.viewport), this.setUserAgent(options.userAgent)]);\n  }\n\n  async setJavaScriptEnabled(enabled) {\n    if (this._javascriptEnabled === enabled) return;\n    this._javascriptEnabled = enabled;\n    await this._client.send('Emulation.setScriptExecutionDisabled', {\n      value: !enabled\n    });\n  }\n\n  async setBypassCSP(enabled) {\n    await this._client.send('Page.setBypassCSP', {\n      enabled\n    });\n  }\n\n  async emulateMediaType(type) {\n    assert_js_1.assert(type === 'screen' || type === 'print' || type === null, 'Unsupported media type: ' + type);\n    await this._client.send('Emulation.setEmulatedMedia', {\n      media: type || ''\n    });\n  }\n\n  async emulateMediaFeatures(features) {\n    if (features === null) await this._client.send('Emulation.setEmulatedMedia', {\n      features: null\n    });\n\n    if (Array.isArray(features)) {\n      features.every(mediaFeature => {\n        const name = mediaFeature.name;\n        assert_js_1.assert(/^prefers-(?:color-scheme|reduced-motion)$/.test(name), 'Unsupported media feature: ' + name);\n        return true;\n      });\n      await this._client.send('Emulation.setEmulatedMedia', {\n        features: features\n      });\n    }\n  }\n\n  async emulateTimezone(timezoneId) {\n    try {\n      await this._client.send('Emulation.setTimezoneOverride', {\n        timezoneId: timezoneId || ''\n      });\n    } catch (error) {\n      if (error.message.includes('Invalid timezone')) throw new Error(`Invalid timezone ID: ${timezoneId}`);\n      throw error;\n    }\n  }\n  /**\n   * Simulates the given vision deficiency on the page.\n   *\n   * @example\n   * ```js\n   * const puppeteer = require('puppeteer');\n   *\n   * (async () => {\n   *   const browser = await puppeteer.launch();\n   *   const page = await browser.newPage();\n   *   await page.goto('https://v8.dev/blog/10-years');\n   *\n   *   await page.emulateVisionDeficiency('achromatopsia');\n   *   await page.screenshot({ path: 'achromatopsia.png' });\n   *\n   *   await page.emulateVisionDeficiency('deuteranopia');\n   *   await page.screenshot({ path: 'deuteranopia.png' });\n   *\n   *   await page.emulateVisionDeficiency('blurredVision');\n   *   await page.screenshot({ path: 'blurred-vision.png' });\n   *\n   *   await browser.close();\n   * })();\n   * ```\n   *\n   * @param type - the type of deficiency to simulate, or `'none'` to reset.\n   */\n\n\n  async emulateVisionDeficiency(type) {\n    const visionDeficiencies = new Set(['none', 'achromatopsia', 'blurredVision', 'deuteranopia', 'protanopia', 'tritanopia']);\n\n    try {\n      assert_js_1.assert(!type || visionDeficiencies.has(type), `Unsupported vision deficiency: ${type}`);\n      await this._client.send('Emulation.setEmulatedVisionDeficiency', {\n        type: type || 'none'\n      });\n    } catch (error) {\n      throw error;\n    }\n  }\n\n  async setViewport(viewport) {\n    const needsReload = await this._emulationManager.emulateViewport(viewport);\n    this._viewport = viewport;\n    if (needsReload) await this.reload();\n  }\n\n  viewport() {\n    return this._viewport;\n  }\n  /**\n   * @remarks\n   *\n   * Evaluates a function in the page's context and returns the result.\n   *\n   * If the function passed to `page.evaluteHandle` returns a Promise, the\n   * function will wait for the promise to resolve and return its value.\n   *\n   * @example\n   *\n   * ```js\n   * const result = await frame.evaluate(() => {\n   *   return Promise.resolve(8 * 7);\n   * });\n   * console.log(result); // prints \"56\"\n   * ```\n   *\n   * You can pass a string instead of a function (although functions are\n   * recommended as they are easier to debug and use with TypeScript):\n   *\n   * @example\n   * ```\n   * const aHandle = await page.evaluate('1 + 2');\n   * ```\n   *\n   * To get the best TypeScript experience, you should pass in as the\n   * generic the type of `pageFunction`:\n   *\n   * ```\n   * const aHandle = await page.evaluate<() => number>(() => 2);\n   * ```\n   *\n   * @example\n   *\n   * {@link ElementHandle} instances (including {@link JSHandle}s) can be passed\n   * as arguments to the `pageFunction`:\n   *\n   * ```\n   * const bodyHandle = await page.$('body');\n   * const html = await page.evaluate(body => body.innerHTML, bodyHandle);\n   * await bodyHandle.dispose();\n   * ```\n   *\n   * @param pageFunction - a function that is run within the page\n   * @param args - arguments to be passed to the pageFunction\n   *\n   * @returns the return value of `pageFunction`.\n   */\n\n\n  async evaluate(pageFunction, ...args) {\n    return this._frameManager.mainFrame().evaluate(pageFunction, ...args);\n  }\n\n  async evaluateOnNewDocument(pageFunction, ...args) {\n    const source = helper_js_1.helper.evaluationString(pageFunction, ...args);\n    await this._client.send('Page.addScriptToEvaluateOnNewDocument', {\n      source\n    });\n  }\n\n  async setCacheEnabled(enabled = true) {\n    await this._frameManager.networkManager().setCacheEnabled(enabled);\n  }\n\n  async screenshot(options = {}) {\n    let screenshotType = null; // options.type takes precedence over inferring the type from options.path\n    // because it may be a 0-length file with no extension created beforehand\n    // (i.e. as a temp file).\n\n    if (options.type) {\n      assert_js_1.assert(options.type === 'png' || options.type === 'jpeg', 'Unknown options.type value: ' + options.type);\n      screenshotType = options.type;\n    } else if (options.path) {\n      const mimeType = mime.getType(options.path);\n      if (mimeType === 'image/png') screenshotType = 'png';else if (mimeType === 'image/jpeg') screenshotType = 'jpeg';\n      assert_js_1.assert(screenshotType, 'Unsupported screenshot mime type: ' + mimeType);\n    }\n\n    if (!screenshotType) screenshotType = 'png';\n\n    if (options.quality) {\n      assert_js_1.assert(screenshotType === 'jpeg', 'options.quality is unsupported for the ' + screenshotType + ' screenshots');\n      assert_js_1.assert(typeof options.quality === 'number', 'Expected options.quality to be a number but found ' + typeof options.quality);\n      assert_js_1.assert(Number.isInteger(options.quality), 'Expected options.quality to be an integer');\n      assert_js_1.assert(options.quality >= 0 && options.quality <= 100, 'Expected options.quality to be between 0 and 100 (inclusive), got ' + options.quality);\n    }\n\n    assert_js_1.assert(!options.clip || !options.fullPage, 'options.clip and options.fullPage are exclusive');\n\n    if (options.clip) {\n      assert_js_1.assert(typeof options.clip.x === 'number', 'Expected options.clip.x to be a number but found ' + typeof options.clip.x);\n      assert_js_1.assert(typeof options.clip.y === 'number', 'Expected options.clip.y to be a number but found ' + typeof options.clip.y);\n      assert_js_1.assert(typeof options.clip.width === 'number', 'Expected options.clip.width to be a number but found ' + typeof options.clip.width);\n      assert_js_1.assert(typeof options.clip.height === 'number', 'Expected options.clip.height to be a number but found ' + typeof options.clip.height);\n      assert_js_1.assert(options.clip.width !== 0, 'Expected options.clip.width not to be 0.');\n      assert_js_1.assert(options.clip.height !== 0, 'Expected options.clip.height not to be 0.');\n    }\n\n    return this._screenshotTaskQueue.postTask(() => this._screenshotTask(screenshotType, options));\n  }\n\n  async _screenshotTask(format, options) {\n    await this._client.send('Target.activateTarget', {\n      targetId: this._target._targetId\n    });\n    let clip = options.clip ? processClip(options.clip) : undefined;\n\n    if (options.fullPage) {\n      const metrics = await this._client.send('Page.getLayoutMetrics');\n      const width = Math.ceil(metrics.contentSize.width);\n      const height = Math.ceil(metrics.contentSize.height); // Overwrite clip for full page at all times.\n\n      clip = {\n        x: 0,\n        y: 0,\n        width,\n        height,\n        scale: 1\n      };\n      const {\n        isMobile = false,\n        deviceScaleFactor = 1,\n        isLandscape = false\n      } = this._viewport || {};\n      const screenOrientation = isLandscape ? {\n        angle: 90,\n        type: 'landscapePrimary'\n      } : {\n        angle: 0,\n        type: 'portraitPrimary'\n      };\n      await this._client.send('Emulation.setDeviceMetricsOverride', {\n        mobile: isMobile,\n        width,\n        height,\n        deviceScaleFactor,\n        screenOrientation\n      });\n    }\n\n    const shouldSetDefaultBackground = options.omitBackground && format === 'png';\n    if (shouldSetDefaultBackground) await this._client.send('Emulation.setDefaultBackgroundColorOverride', {\n      color: {\n        r: 0,\n        g: 0,\n        b: 0,\n        a: 0\n      }\n    });\n    const result = await this._client.send('Page.captureScreenshot', {\n      format,\n      quality: options.quality,\n      clip\n    });\n    if (shouldSetDefaultBackground) await this._client.send('Emulation.setDefaultBackgroundColorOverride');\n    if (options.fullPage && this._viewport) await this.setViewport(this._viewport);\n    const buffer = options.encoding === 'base64' ? result.data : Buffer.from(result.data, 'base64');\n    if (options.path) await writeFileAsync(options.path, buffer);\n    return buffer;\n\n    function processClip(clip) {\n      const x = Math.round(clip.x);\n      const y = Math.round(clip.y);\n      const width = Math.round(clip.width + clip.x - x);\n      const height = Math.round(clip.height + clip.y - y);\n      return {\n        x,\n        y,\n        width,\n        height,\n        scale: 1\n      };\n    }\n  }\n  /**\n   * Generatees a PDF of the page with the `print` CSS media type.\n   * @remarks\n   *\n   * IMPORTANT: PDF generation is only supported in Chrome headless mode.\n   *\n   * To generate a PDF with the `screen` media type, call\n   * {@link Page.emulateMediaType | `page.emulateMediaType('screen')`} before\n   * calling `page.pdf()`.\n   *\n   * By default, `page.pdf()` generates a pdf with modified colors for printing.\n   * Use the\n   * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/-webkit-print-color-adjust | `-webkit-print-color-adjust`}\n   * property to force rendering of exact colors.\n   *\n   *\n   * @param options - options for generating the PDF.\n   */\n\n\n  async pdf(options = {}) {\n    const {\n      scale = 1,\n      displayHeaderFooter = false,\n      headerTemplate = '',\n      footerTemplate = '',\n      printBackground = false,\n      landscape = false,\n      pageRanges = '',\n      preferCSSPageSize = false,\n      margin = {},\n      path = null\n    } = options;\n    let paperWidth = 8.5;\n    let paperHeight = 11;\n\n    if (options.format) {\n      const format = PDFOptions_js_1.paperFormats[options.format.toLowerCase()];\n      assert_js_1.assert(format, 'Unknown paper format: ' + options.format);\n      paperWidth = format.width;\n      paperHeight = format.height;\n    } else {\n      paperWidth = convertPrintParameterToInches(options.width) || paperWidth;\n      paperHeight = convertPrintParameterToInches(options.height) || paperHeight;\n    }\n\n    const marginTop = convertPrintParameterToInches(margin.top) || 0;\n    const marginLeft = convertPrintParameterToInches(margin.left) || 0;\n    const marginBottom = convertPrintParameterToInches(margin.bottom) || 0;\n    const marginRight = convertPrintParameterToInches(margin.right) || 0;\n    const result = await this._client.send('Page.printToPDF', {\n      transferMode: 'ReturnAsStream',\n      landscape,\n      displayHeaderFooter,\n      headerTemplate,\n      footerTemplate,\n      printBackground,\n      scale,\n      paperWidth,\n      paperHeight,\n      marginTop,\n      marginBottom,\n      marginLeft,\n      marginRight,\n      pageRanges,\n      preferCSSPageSize\n    });\n    return await helper_js_1.helper.readProtocolStream(this._client, result.stream, path);\n  }\n\n  async title() {\n    return this.mainFrame().title();\n  }\n\n  async close(options = {\n    runBeforeUnload: undefined\n  }) {\n    assert_js_1.assert(!!this._client._connection, 'Protocol error: Connection closed. Most likely the page has been closed.');\n    const runBeforeUnload = !!options.runBeforeUnload;\n\n    if (runBeforeUnload) {\n      await this._client.send('Page.close');\n    } else {\n      await this._client._connection.send('Target.closeTarget', {\n        targetId: this._target._targetId\n      });\n      await this._target._isClosedPromise;\n    }\n  }\n\n  isClosed() {\n    return this._closed;\n  }\n\n  get mouse() {\n    return this._mouse;\n  }\n\n  click(selector, options = {}) {\n    return this.mainFrame().click(selector, options);\n  }\n\n  focus(selector) {\n    return this.mainFrame().focus(selector);\n  }\n\n  hover(selector) {\n    return this.mainFrame().hover(selector);\n  }\n\n  select(selector, ...values) {\n    return this.mainFrame().select(selector, ...values);\n  }\n\n  tap(selector) {\n    return this.mainFrame().tap(selector);\n  }\n\n  type(selector, text, options) {\n    return this.mainFrame().type(selector, text, options);\n  }\n  /**\n   * @remarks\n   *\n   * This method behaves differently depending on the first parameter. If it's a\n   * `string`, it will be treated as a `selector` or `xpath` (if the string\n   * starts with `//`). This method then is a shortcut for\n   * {@link Page.waitForSelector} or {@link Page.waitForXPath}.\n   *\n   * If the first argument is a function this method is a shortcut for\n   * {@link Page.waitForFunction}.\n   *\n   * If the first argument is a `number`, it's treated as a timeout in\n   * milliseconds and the method returns a promise which resolves after the\n   * timeout.\n   *\n   * @param selectorOrFunctionOrTimeout - a selector, predicate or timeout to\n   * wait for.\n   * @param options - optional waiting parameters.\n   * @param args - arguments to pass to `pageFunction`.\n   *\n   * @deprecated Don't use this method directly. Instead use the more explicit\n   * methods available: {@link Page.waitForSelector},\n   * {@link Page.waitForXPath}, {@link Page.waitForFunction} or\n   * {@link Page.waitForTimeout}.\n   */\n\n\n  waitFor(selectorOrFunctionOrTimeout, options = {}, ...args) {\n    return this.mainFrame().waitFor(selectorOrFunctionOrTimeout, options, ...args);\n  }\n  /**\n   * Causes your script to wait for the given number of milliseconds.\n   *\n   * @remarks\n   *\n   * It's generally recommended to not wait for a number of seconds, but instead\n   * use {@link Page.waitForSelector}, {@link Page.waitForXPath} or\n   * {@link Page.waitForFunction} to wait for exactly the conditions you want.\n   *\n   * @example\n   *\n   * Wait for 1 second:\n   *\n   * ```\n   * await page.waitForTimeout(1000);\n   * ```\n   *\n   * @param milliseconds - the number of milliseconds to wait.\n   */\n\n\n  waitForTimeout(milliseconds) {\n    return this.mainFrame().waitForTimeout(milliseconds);\n  }\n\n  waitForSelector(selector, options = {}) {\n    return this.mainFrame().waitForSelector(selector, options);\n  }\n\n  waitForXPath(xpath, options = {}) {\n    return this.mainFrame().waitForXPath(xpath, options);\n  }\n\n  waitForFunction(pageFunction, options = {}, ...args) {\n    return this.mainFrame().waitForFunction(pageFunction, options, ...args);\n  }\n\n}\n\nexports.Page = Page;\nconst supportedMetrics = new Set(['Timestamp', 'Documents', 'Frames', 'JSEventListeners', 'Nodes', 'LayoutCount', 'RecalcStyleCount', 'LayoutDuration', 'RecalcStyleDuration', 'ScriptDuration', 'TaskDuration', 'JSHeapUsedSize', 'JSHeapTotalSize']);\nconst unitToPixels = {\n  px: 1,\n  in: 96,\n  cm: 37.8,\n  mm: 3.78\n};\n\nfunction convertPrintParameterToInches(parameter) {\n  if (typeof parameter === 'undefined') return undefined;\n  let pixels;\n\n  if (helper_js_1.helper.isNumber(parameter)) {\n    // Treat numbers as pixel values to be aligned with phantom's paperSize.\n    pixels =\n    /** @type {number} */\n    parameter;\n  } else if (helper_js_1.helper.isString(parameter)) {\n    const text =\n    /** @type {string} */\n    parameter;\n    let unit = text.substring(text.length - 2).toLowerCase();\n    let valueText = '';\n\n    if (unitToPixels.hasOwnProperty(unit)) {\n      valueText = text.substring(0, text.length - 2);\n    } else {\n      // In case of unknown unit try to parse the whole parameter as number of pixels.\n      // This is consistent with phantom's paperSize behavior.\n      unit = 'px';\n      valueText = text;\n    }\n\n    const value = Number(valueText);\n    assert_js_1.assert(!isNaN(value), 'Failed to parse parameter value: ' + text);\n    pixels = value * unitToPixels[unit];\n  } else {\n    throw new Error('page.pdf() Cannot handle parameter type: ' + typeof parameter);\n  }\n\n  return pixels / 96;\n}","map":{"version":3,"sources":["C:/Users/Sajjad Brohi/JavaScript Projects/RESTful API/packages/client/node_modules/puppeteer/lib/cjs/puppeteer/common/Page.js"],"names":["__createBinding","Object","create","o","m","k","k2","undefined","defineProperty","enumerable","get","__setModuleDefault","v","value","__importStar","mod","__esModule","result","hasOwnProperty","call","exports","Page","fs","require","util_1","EventEmitter_js_1","mime","Connection_js_1","Dialog_js_1","EmulationManager_js_1","FrameManager_js_1","Input_js_1","Tracing_js_1","assert_js_1","helper_js_1","Coverage_js_1","WebWorker_js_1","JSHandle_js_1","NetworkManager_js_1","Accessibility_js_1","TimeoutSettings_js_1","FileChooser_js_1","ConsoleMessage_js_1","PDFOptions_js_1","writeFileAsync","promisify","writeFile","ScreenshotTaskQueue","constructor","_chain","Promise","resolve","postTask","task","then","catch","EventEmitter","client","target","ignoreHTTPSErrors","_closed","_timeoutSettings","TimeoutSettings","_pageBindings","Map","_javascriptEnabled","_workers","_fileChooserInterceptors","Set","_client","_target","_keyboard","Keyboard","_mouse","Mouse","_touchscreen","Touchscreen","_accessibility","Accessibility","_frameManager","FrameManager","_emulationManager","EmulationManager","_tracing","Tracing","_coverage","Coverage","_screenshotTaskQueue","_viewport","on","event","targetInfo","type","send","sessionId","debugError","session","Connection","fromSession","worker","WebWorker","url","_addConsoleMessage","bind","_handleException","set","emit","delete","FrameManagerEmittedEvents","FrameAttached","FrameDetached","FrameNavigated","networkManager","NetworkManagerEmittedEvents","Request","Response","RequestFailed","RequestFinished","_onConsoleAPI","_onBindingCalled","_onDialog","exception","exceptionDetails","_onTargetCrashed","_emitMetrics","_onLogEntryAdded","_onFileChooser","_isClosedPromise","defaultViewport","page","_initialize","setViewport","all","initialize","autoAttach","waitForDebuggerOnStart","flatten","size","frame","frameId","context","executionContext","element","_adoptBackendNodeId","backendNodeId","interceptors","Array","from","clear","fileChooser","FileChooser","interceptor","isJavaScriptEnabled","waitForFileChooser","options","enabled","timeout","callback","promise","x","add","helper","waitWithTimeout","error","setGeolocation","longitude","latitude","accuracy","Error","browser","browserContext","level","text","args","source","lineNumber","entry","map","arg","releaseObject","ConsoleMessage","mainFrame","keyboard","touchscreen","coverage","tracing","accessibility","frames","workers","values","setRequestInterception","setOfflineMode","setDefaultNavigationTimeout","setDefaultTimeout","$","selector","evaluateHandle","pageFunction","queryObjects","prototypeHandle","$eval","$$eval","$$","$x","expression","cookies","urls","originalCookies","length","unsupportedCookieAttributes","filterUnsupportedAttributes","cookie","attr","deleteCookie","pageURL","item","assign","startsWith","setCookie","startsWithHTTP","items","assert","name","String","prototype","addScriptTag","addStyleTag","exposeFunction","puppeteerFunction","has","evaluationString","addPageBinding","evaluate","bindingName","win","window","binding","me","callbacks","seq","reject","JSON","stringify","authenticate","credentials","setExtraHTTPHeaders","headers","setUserAgent","userAgent","metrics","response","_buildMetricsObject","title","metric","supportedMetrics","message","getExceptionMessage","err","stack","executionContextId","executionContextById","createJSHandle","stackTrace","parse","payload","deliverResult","deliverError","deliverErrorValue","contextId","listenerCount","forEach","dispose","textTokens","remoteObject","_remoteObject","objectId","push","toString","valueFromRemoteObject","location","callFrames","columnNumber","join","dialogType","validDialogTypes","dialog","Dialog","defaultPrompt","content","setContent","html","goto","reload","waitForNavigation","_sessionClosePromise","_disconnectPromise","fulfill","once","CDPSessionEmittedEvents","Disconnected","waitForRequest","urlOrPredicate","waitForEvent","request","isString","waitForResponse","goBack","_go","goForward","delta","history","entries","currentIndex","entryId","id","bringToFront","emulate","viewport","setJavaScriptEnabled","setBypassCSP","emulateMediaType","media","emulateMediaFeatures","features","isArray","every","mediaFeature","test","emulateTimezone","timezoneId","includes","emulateVisionDeficiency","visionDeficiencies","needsReload","emulateViewport","evaluateOnNewDocument","setCacheEnabled","screenshot","screenshotType","path","mimeType","getType","quality","Number","isInteger","clip","fullPage","y","width","height","_screenshotTask","format","targetId","_targetId","processClip","Math","ceil","contentSize","scale","isMobile","deviceScaleFactor","isLandscape","screenOrientation","angle","mobile","shouldSetDefaultBackground","omitBackground","color","r","g","b","a","buffer","encoding","data","Buffer","round","pdf","displayHeaderFooter","headerTemplate","footerTemplate","printBackground","landscape","pageRanges","preferCSSPageSize","margin","paperWidth","paperHeight","paperFormats","toLowerCase","convertPrintParameterToInches","marginTop","top","marginLeft","left","marginBottom","bottom","marginRight","right","transferMode","readProtocolStream","stream","close","runBeforeUnload","_connection","isClosed","mouse","click","focus","hover","select","tap","waitFor","selectorOrFunctionOrTimeout","waitForTimeout","milliseconds","waitForSelector","waitForXPath","xpath","waitForFunction","unitToPixels","px","in","cm","mm","parameter","pixels","isNumber","unit","substring","valueText","isNaN"],"mappings":"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","sourcesContent":["\"use strict\";\n/**\n * Copyright 2017 Google Inc. All rights reserved.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *     http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Page = void 0;\nconst fs = __importStar(require(\"fs\"));\nconst util_1 = require(\"util\");\nconst EventEmitter_js_1 = require(\"./EventEmitter.js\");\nconst mime = __importStar(require(\"mime\"));\nconst Connection_js_1 = require(\"./Connection.js\");\nconst Dialog_js_1 = require(\"./Dialog.js\");\nconst EmulationManager_js_1 = require(\"./EmulationManager.js\");\nconst FrameManager_js_1 = require(\"./FrameManager.js\");\nconst Input_js_1 = require(\"./Input.js\");\nconst Tracing_js_1 = require(\"./Tracing.js\");\nconst assert_js_1 = require(\"./assert.js\");\nconst helper_js_1 = require(\"./helper.js\");\nconst Coverage_js_1 = require(\"./Coverage.js\");\nconst WebWorker_js_1 = require(\"./WebWorker.js\");\nconst JSHandle_js_1 = require(\"./JSHandle.js\");\nconst NetworkManager_js_1 = require(\"./NetworkManager.js\");\nconst Accessibility_js_1 = require(\"./Accessibility.js\");\nconst TimeoutSettings_js_1 = require(\"./TimeoutSettings.js\");\nconst FileChooser_js_1 = require(\"./FileChooser.js\");\nconst ConsoleMessage_js_1 = require(\"./ConsoleMessage.js\");\nconst PDFOptions_js_1 = require(\"./PDFOptions.js\");\nconst writeFileAsync = util_1.promisify(fs.writeFile);\nclass ScreenshotTaskQueue {\n    constructor() {\n        this._chain = Promise.resolve(undefined);\n    }\n    postTask(task) {\n        const result = this._chain.then(task);\n        this._chain = result.catch(() => { });\n        return result;\n    }\n}\n/**\n * Page provides methods to interact with a single tab or\n * {@link https://developer.chrome.com/extensions/background_pages | extension background page} in Chromium.\n *\n * @remarks\n *\n * One Browser instance might have multiple Page instances.\n *\n * @example\n * This example creates a page, navigates it to a URL, and then * saves a screenshot:\n * ```js\n * const puppeteer = require('puppeteer');\n *\n * (async () => {\n *   const browser = await puppeteer.launch();\n *   const page = await browser.newPage();\n *   await page.goto('https://example.com');\n *   await page.screenshot({path: 'screenshot.png'});\n *   await browser.close();\n * })();\n * ```\n *\n * The Page class extends from Puppeteer's {@link EventEmitter} class and will\n * emit various events which are documented in the {@link PageEmittedEvents} enum.\n *\n * @example\n * This example logs a message for a single page `load` event:\n * ```js\n * page.once('load', () => console.log('Page loaded!'));\n * ```\n *\n * To unsubscribe from events use the `off` method:\n *\n * ```js\n * function logRequest(interceptedRequest) {\n *   console.log('A request was made:', interceptedRequest.url());\n * }\n * page.on('request', logRequest);\n * // Sometime later...\n * page.off('request', logRequest);\n * ```\n * @public\n */\nclass Page extends EventEmitter_js_1.EventEmitter {\n    /**\n     * @internal\n     */\n    constructor(client, target, ignoreHTTPSErrors) {\n        super();\n        this._closed = false;\n        this._timeoutSettings = new TimeoutSettings_js_1.TimeoutSettings();\n        this._pageBindings = new Map();\n        this._javascriptEnabled = true;\n        this._workers = new Map();\n        // TODO: improve this typedef - it's a function that takes a file chooser or\n        // something?\n        this._fileChooserInterceptors = new Set();\n        this._client = client;\n        this._target = target;\n        this._keyboard = new Input_js_1.Keyboard(client);\n        this._mouse = new Input_js_1.Mouse(client, this._keyboard);\n        this._touchscreen = new Input_js_1.Touchscreen(client, this._keyboard);\n        this._accessibility = new Accessibility_js_1.Accessibility(client);\n        this._frameManager = new FrameManager_js_1.FrameManager(client, this, ignoreHTTPSErrors, this._timeoutSettings);\n        this._emulationManager = new EmulationManager_js_1.EmulationManager(client);\n        this._tracing = new Tracing_js_1.Tracing(client);\n        this._coverage = new Coverage_js_1.Coverage(client);\n        this._screenshotTaskQueue = new ScreenshotTaskQueue();\n        this._viewport = null;\n        client.on('Target.attachedToTarget', (event) => {\n            if (event.targetInfo.type !== 'worker') {\n                // If we don't detach from service workers, they will never die.\n                client\n                    .send('Target.detachFromTarget', {\n                    sessionId: event.sessionId,\n                })\n                    .catch(helper_js_1.debugError);\n                return;\n            }\n            const session = Connection_js_1.Connection.fromSession(client).session(event.sessionId);\n            const worker = new WebWorker_js_1.WebWorker(session, event.targetInfo.url, this._addConsoleMessage.bind(this), this._handleException.bind(this));\n            this._workers.set(event.sessionId, worker);\n            this.emit(\"workercreated\" /* WorkerCreated */, worker);\n        });\n        client.on('Target.detachedFromTarget', (event) => {\n            const worker = this._workers.get(event.sessionId);\n            if (!worker)\n                return;\n            this.emit(\"workerdestroyed\" /* WorkerDestroyed */, worker);\n            this._workers.delete(event.sessionId);\n        });\n        this._frameManager.on(FrameManager_js_1.FrameManagerEmittedEvents.FrameAttached, (event) => this.emit(\"frameattached\" /* FrameAttached */, event));\n        this._frameManager.on(FrameManager_js_1.FrameManagerEmittedEvents.FrameDetached, (event) => this.emit(\"framedetached\" /* FrameDetached */, event));\n        this._frameManager.on(FrameManager_js_1.FrameManagerEmittedEvents.FrameNavigated, (event) => this.emit(\"framenavigated\" /* FrameNavigated */, event));\n        const networkManager = this._frameManager.networkManager();\n        networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.Request, (event) => this.emit(\"request\" /* Request */, event));\n        networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.Response, (event) => this.emit(\"response\" /* Response */, event));\n        networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.RequestFailed, (event) => this.emit(\"requestfailed\" /* RequestFailed */, event));\n        networkManager.on(NetworkManager_js_1.NetworkManagerEmittedEvents.RequestFinished, (event) => this.emit(\"requestfinished\" /* RequestFinished */, event));\n        this._fileChooserInterceptors = new Set();\n        client.on('Page.domContentEventFired', () => this.emit(\"domcontentloaded\" /* DOMContentLoaded */));\n        client.on('Page.loadEventFired', () => this.emit(\"load\" /* Load */));\n        client.on('Runtime.consoleAPICalled', (event) => this._onConsoleAPI(event));\n        client.on('Runtime.bindingCalled', (event) => this._onBindingCalled(event));\n        client.on('Page.javascriptDialogOpening', (event) => this._onDialog(event));\n        client.on('Runtime.exceptionThrown', (exception) => this._handleException(exception.exceptionDetails));\n        client.on('Inspector.targetCrashed', () => this._onTargetCrashed());\n        client.on('Performance.metrics', (event) => this._emitMetrics(event));\n        client.on('Log.entryAdded', (event) => this._onLogEntryAdded(event));\n        client.on('Page.fileChooserOpened', (event) => this._onFileChooser(event));\n        this._target._isClosedPromise.then(() => {\n            this.emit(\"close\" /* Close */);\n            this._closed = true;\n        });\n    }\n    /**\n     * @internal\n     */\n    static async create(client, target, ignoreHTTPSErrors, defaultViewport) {\n        const page = new Page(client, target, ignoreHTTPSErrors);\n        await page._initialize();\n        if (defaultViewport)\n            await page.setViewport(defaultViewport);\n        return page;\n    }\n    async _initialize() {\n        await Promise.all([\n            this._frameManager.initialize(),\n            this._client.send('Target.setAutoAttach', {\n                autoAttach: true,\n                waitForDebuggerOnStart: false,\n                flatten: true,\n            }),\n            this._client.send('Performance.enable'),\n            this._client.send('Log.enable'),\n        ]);\n    }\n    async _onFileChooser(event) {\n        if (!this._fileChooserInterceptors.size)\n            return;\n        const frame = this._frameManager.frame(event.frameId);\n        const context = await frame.executionContext();\n        const element = await context._adoptBackendNodeId(event.backendNodeId);\n        const interceptors = Array.from(this._fileChooserInterceptors);\n        this._fileChooserInterceptors.clear();\n        const fileChooser = new FileChooser_js_1.FileChooser(element, event);\n        for (const interceptor of interceptors)\n            interceptor.call(null, fileChooser);\n    }\n    /**\n     * @returns `true` if the page has JavaScript enabled, `false` otherwise.\n     */\n    isJavaScriptEnabled() {\n        return this._javascriptEnabled;\n    }\n    /**\n     * @param options - Optional waiting parameters\n     * @returns Resolves after a page requests a file picker.\n     */\n    async waitForFileChooser(options = {}) {\n        if (!this._fileChooserInterceptors.size)\n            await this._client.send('Page.setInterceptFileChooserDialog', {\n                enabled: true,\n            });\n        const { timeout = this._timeoutSettings.timeout() } = options;\n        let callback;\n        const promise = new Promise((x) => (callback = x));\n        this._fileChooserInterceptors.add(callback);\n        return helper_js_1.helper\n            .waitWithTimeout(promise, 'waiting for file chooser', timeout)\n            .catch((error) => {\n            this._fileChooserInterceptors.delete(callback);\n            throw error;\n        });\n    }\n    /**\n     * Sets the page's geolocation.\n     *\n     * @remarks\n     * Consider using {@link BrowserContext.overridePermissions} to grant\n     * permissions for the page to read its geolocation.\n     *\n     * @example\n     * ```js\n     * await page.setGeolocation({latitude: 59.95, longitude: 30.31667});\n     * ```\n     */\n    async setGeolocation(options) {\n        const { longitude, latitude, accuracy = 0 } = options;\n        if (longitude < -180 || longitude > 180)\n            throw new Error(`Invalid longitude \"${longitude}\": precondition -180 <= LONGITUDE <= 180 failed.`);\n        if (latitude < -90 || latitude > 90)\n            throw new Error(`Invalid latitude \"${latitude}\": precondition -90 <= LATITUDE <= 90 failed.`);\n        if (accuracy < 0)\n            throw new Error(`Invalid accuracy \"${accuracy}\": precondition 0 <= ACCURACY failed.`);\n        await this._client.send('Emulation.setGeolocationOverride', {\n            longitude,\n            latitude,\n            accuracy,\n        });\n    }\n    /**\n     * @returns A target this page was created from.\n     */\n    target() {\n        return this._target;\n    }\n    /**\n     * @returns The browser this page belongs to.\n     */\n    browser() {\n        return this._target.browser();\n    }\n    /**\n     * @returns The browser context that the page belongs to\n     */\n    browserContext() {\n        return this._target.browserContext();\n    }\n    _onTargetCrashed() {\n        this.emit('error', new Error('Page crashed!'));\n    }\n    _onLogEntryAdded(event) {\n        const { level, text, args, source, url, lineNumber } = event.entry;\n        if (args)\n            args.map((arg) => helper_js_1.helper.releaseObject(this._client, arg));\n        if (source !== 'worker')\n            this.emit(\"console\" /* Console */, new ConsoleMessage_js_1.ConsoleMessage(level, text, [], { url, lineNumber }));\n    }\n    /**\n     * @returns The page's main frame.\n     */\n    mainFrame() {\n        return this._frameManager.mainFrame();\n    }\n    get keyboard() {\n        return this._keyboard;\n    }\n    get touchscreen() {\n        return this._touchscreen;\n    }\n    get coverage() {\n        return this._coverage;\n    }\n    get tracing() {\n        return this._tracing;\n    }\n    get accessibility() {\n        return this._accessibility;\n    }\n    /**\n     * @returns An array of all frames attached to the page.\n     */\n    frames() {\n        return this._frameManager.frames();\n    }\n    /**\n     * @returns all of the dedicated\n     * {@link https://developer.mozilla.org/en-US/docs/Web/API/Web_Workers_API | WebWorkers}\n     * associated with the page.\n     */\n    workers() {\n        return Array.from(this._workers.values());\n    }\n    /**\n     * @param value - Whether to enable request interception.\n     *\n     * @remarks\n     * Activating request interception enables {@link HTTPRequest.abort},\n     * {@link HTTPRequest.continue} and {@link HTTPRequest.respond} methods.  This\n     * provides the capability to modify network requests that are made by a page.\n     *\n     * Once request interception is enabled, every request will stall unless it's\n     * continued, responded or aborted.\n     *\n     * **NOTE** Enabling request interception disables page caching.\n     *\n     * @example\n     * An example of a naïve request interceptor that aborts all image requests:\n     * ```js\n     * const puppeteer = require('puppeteer');\n     * (async () => {\n     *   const browser = await puppeteer.launch();\n     *   const page = await browser.newPage();\n     *   await page.setRequestInterception(true);\n     *   page.on('request', interceptedRequest => {\n     *     if (interceptedRequest.url().endsWith('.png') ||\n     *         interceptedRequest.url().endsWith('.jpg'))\n     *       interceptedRequest.abort();\n     *     else\n     *       interceptedRequest.continue();\n     *     });\n     *   await page.goto('https://example.com');\n     *   await browser.close();\n     * })();\n     * ```\n     */\n    async setRequestInterception(value) {\n        return this._frameManager.networkManager().setRequestInterception(value);\n    }\n    /**\n     * @param enabled - When `true`, enables offline mode for the page.\n     */\n    setOfflineMode(enabled) {\n        return this._frameManager.networkManager().setOfflineMode(enabled);\n    }\n    /**\n     * @param timeout - Maximum navigation time in milliseconds.\n     */\n    setDefaultNavigationTimeout(timeout) {\n        this._timeoutSettings.setDefaultNavigationTimeout(timeout);\n    }\n    /**\n     * @param timeout - Maximum time in milliseconds.\n     */\n    setDefaultTimeout(timeout) {\n        this._timeoutSettings.setDefaultTimeout(timeout);\n    }\n    /**\n     * Runs `document.querySelector` within the page. If no element matches the\n     * selector, the return value resolves to `null`.\n     *\n     * @remarks\n     * Shortcut for {@link Frame.$ | Page.mainFrame().$(selector) }.\n     *\n     * @param selector - A\n     * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors | selector}\n     * to query page for.\n     */\n    async $(selector) {\n        return this.mainFrame().$(selector);\n    }\n    /**\n     * @remarks\n     *\n     * The only difference between {@link Page.evaluate | page.evaluate} and\n     * `page.evaluateHandle` is that `evaluateHandle` will return the value\n     * wrapped in an in-page object.\n     *\n     * If the function passed to `page.evaluteHandle` returns a Promise, the\n     * function will wait for the promise to resolve and return its value.\n     *\n     * You can pass a string instead of a function (although functions are\n     * recommended as they are easier to debug and use with TypeScript):\n     *\n     * @example\n     * ```\n     * const aHandle = await page.evaluateHandle('document')\n     * ```\n     *\n     * @example\n     * {@link JSHandle} instances can be passed as arguments to the `pageFunction`:\n     * ```\n     * const aHandle = await page.evaluateHandle(() => document.body);\n     * const resultHandle = await page.evaluateHandle(body => body.innerHTML, aHandle);\n     * console.log(await resultHandle.jsonValue());\n     * await resultHandle.dispose();\n     * ```\n     *\n     * Most of the time this function returns a {@link JSHandle},\n     * but if `pageFunction` returns a reference to an element,\n     * you instead get an {@link ElementHandle} back:\n     *\n     * @example\n     * ```\n     * const button = await page.evaluateHandle(() => document.querySelector('button'));\n     * // can call `click` because `button` is an `ElementHandle`\n     * await button.click();\n     * ```\n     *\n     * The TypeScript definitions assume that `evaluateHandle` returns\n     *  a `JSHandle`, but if you know it's going to return an\n     * `ElementHandle`, pass it as the generic argument:\n     *\n     * ```\n     * const button = await page.evaluateHandle<ElementHandle>(...);\n     * ```\n     *\n     * @param pageFunction - a function that is run within the page\n     * @param args - arguments to be passed to the pageFunction\n     */\n    async evaluateHandle(pageFunction, ...args) {\n        const context = await this.mainFrame().executionContext();\n        return context.evaluateHandle(pageFunction, ...args);\n    }\n    /**\n     * This method iterates the JavaScript heap and finds all objects with the\n     * given prototype.\n     *\n     * @remarks\n     *\n     * @example\n     *\n     * ```js\n     * // Create a Map object\n     * await page.evaluate(() => window.map = new Map());\n     * // Get a handle to the Map object prototype\n     * const mapPrototype = await page.evaluateHandle(() => Map.prototype);\n     * // Query all map instances into an array\n     * const mapInstances = await page.queryObjects(mapPrototype);\n     * // Count amount of map objects in heap\n     * const count = await page.evaluate(maps => maps.length, mapInstances);\n     * await mapInstances.dispose();\n     * await mapPrototype.dispose();\n     * ```\n     * @param prototypeHandle - a handle to the object prototype.\n     */\n    async queryObjects(prototypeHandle) {\n        const context = await this.mainFrame().executionContext();\n        return context.queryObjects(prototypeHandle);\n    }\n    /**\n     * This method runs `document.querySelector` within the page and passes the\n     * result as the first argument to the `pageFunction`.\n     *\n     * @remarks\n     *\n     * If no element is found matching `selector`, the method will throw an error.\n     *\n     * If `pageFunction` returns a promise `$eval` will wait for the promise to\n     * resolve and then return its value.\n     *\n     * @example\n     *\n     * ```\n     * const searchValue = await page.$eval('#search', el => el.value);\n     * const preloadHref = await page.$eval('link[rel=preload]', el => el.href);\n     * const html = await page.$eval('.main-container', el => el.outerHTML);\n     * ```\n     *\n     * If you are using TypeScript, you may have to provide an explicit type to the\n     * first argument of the `pageFunction`.\n     * By default it is typed as `Element`, but you may need to provide a more\n     * specific sub-type:\n     *\n     * @example\n     *\n     * ```\n     * // if you don't provide HTMLInputElement here, TS will error\n     * // as `value` is not on `Element`\n     * const searchValue = await page.$eval('#search', (el: HTMLInputElement) => el.value);\n     * ```\n     *\n     * The compiler should be able to infer the return type\n     * from the `pageFunction` you provide. If it is unable to, you can use the generic\n     * type to tell the compiler what return type you expect from `$eval`:\n     *\n     * @example\n     *\n     * ```\n     * // The compiler can infer the return type in this case, but if it can't\n     * // or if you want to be more explicit, provide it as the generic type.\n     * const searchValue = await page.$eval<string>(\n     *  '#search', (el: HTMLInputElement) => el.value\n     * );\n     * ```\n     *\n     * @param selector - the\n     * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors | selector}\n     * to query for\n     * @param pageFunction - the function to be evaluated in the page context.\n     * Will be passed the result of `document.querySelector(selector)` as its\n     * first argument.\n     * @param args - any additional arguments to pass through to `pageFunction`.\n     *\n     * @returns The result of calling `pageFunction`. If it returns an element it\n     * is wrapped in an {@link ElementHandle}, else the raw value itself is\n     * returned.\n     */\n    async $eval(selector, pageFunction, ...args) {\n        return this.mainFrame().$eval(selector, pageFunction, ...args);\n    }\n    /**\n     * This method runs `Array.from(document.querySelectorAll(selector))` within\n     * the page and passes the result as the first argument to the `pageFunction`.\n     *\n     * @remarks\n     *\n     * If `pageFunction` returns a promise `$$eval` will wait for the promise to\n     * resolve and then return its value.\n     *\n     * @example\n     *\n     * ```\n     * // get the amount of divs on the page\n     * const divCount = await page.$$eval('div', divs => divs.length);\n     *\n     * // get the text content of all the `.options` elements:\n     * const options = await page.$$eval('div > span.options', options => {\n     *   return options.map(option => option.textContent)\n     * });\n     * ```\n     *\n     * If you are using TypeScript, you may have to provide an explicit type to the\n     * first argument of the `pageFunction`.\n     * By default it is typed as `Element[]`, but you may need to provide a more\n     * specific sub-type:\n     *\n     * @example\n     *\n     * ```\n     * // if you don't provide HTMLInputElement here, TS will error\n     * // as `value` is not on `Element`\n     * await page.$$eval('input', (elements: HTMLInputElement[]) => {\n     *   return elements.map(e => e.value);\n     * });\n     * ```\n     *\n     * The compiler should be able to infer the return type\n     * from the `pageFunction` you provide. If it is unable to, you can use the generic\n     * type to tell the compiler what return type you expect from `$$eval`:\n     *\n     * @example\n     *\n     * ```\n     * // The compiler can infer the return type in this case, but if it can't\n     * // or if you want to be more explicit, provide it as the generic type.\n     * const allInputValues = await page.$$eval<string[]>(\n     *  'input', (elements: HTMLInputElement[]) => elements.map(e => e.textContent)\n     * );\n     * ```\n     *\n     * @param selector the\n     * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/CSS_Selectors | selector}\n     * to query for\n     * @param pageFunction the function to be evaluated in the page context. Will\n     * be passed the result of `Array.from(document.querySelectorAll(selector))`\n     * as its first argument.\n     * @param args any additional arguments to pass through to `pageFunction`.\n     *\n     * @returns The result of calling `pageFunction`. If it returns an element it\n     * is wrapped in an {@link ElementHandle}, else the raw value itself is\n     * returned.\n     */\n    async $$eval(selector, pageFunction, ...args) {\n        return this.mainFrame().$$eval(selector, pageFunction, ...args);\n    }\n    async $$(selector) {\n        return this.mainFrame().$$(selector);\n    }\n    async $x(expression) {\n        return this.mainFrame().$x(expression);\n    }\n    /**\n     * If no URLs are specified, this method returns cookies for the current page\n     * URL. If URLs are specified, only cookies for those URLs are returned.\n     */\n    async cookies(...urls) {\n        const originalCookies = (await this._client.send('Network.getCookies', {\n            urls: urls.length ? urls : [this.url()],\n        })).cookies;\n        const unsupportedCookieAttributes = ['priority'];\n        const filterUnsupportedAttributes = (cookie) => {\n            for (const attr of unsupportedCookieAttributes)\n                delete cookie[attr];\n            return cookie;\n        };\n        return originalCookies.map(filterUnsupportedAttributes);\n    }\n    async deleteCookie(...cookies) {\n        const pageURL = this.url();\n        for (const cookie of cookies) {\n            const item = Object.assign({}, cookie);\n            if (!cookie.url && pageURL.startsWith('http'))\n                item.url = pageURL;\n            await this._client.send('Network.deleteCookies', item);\n        }\n    }\n    async setCookie(...cookies) {\n        const pageURL = this.url();\n        const startsWithHTTP = pageURL.startsWith('http');\n        const items = cookies.map((cookie) => {\n            const item = Object.assign({}, cookie);\n            if (!item.url && startsWithHTTP)\n                item.url = pageURL;\n            assert_js_1.assert(item.url !== 'about:blank', `Blank page can not have cookie \"${item.name}\"`);\n            assert_js_1.assert(!String.prototype.startsWith.call(item.url || '', 'data:'), `Data URL page can not have cookie \"${item.name}\"`);\n            return item;\n        });\n        await this.deleteCookie(...items);\n        if (items.length)\n            await this._client.send('Network.setCookies', { cookies: items });\n    }\n    async addScriptTag(options) {\n        return this.mainFrame().addScriptTag(options);\n    }\n    async addStyleTag(options) {\n        return this.mainFrame().addStyleTag(options);\n    }\n    async exposeFunction(name, puppeteerFunction) {\n        if (this._pageBindings.has(name))\n            throw new Error(`Failed to add page binding with name ${name}: window['${name}'] already exists!`);\n        this._pageBindings.set(name, puppeteerFunction);\n        const expression = helper_js_1.helper.evaluationString(addPageBinding, name);\n        await this._client.send('Runtime.addBinding', { name: name });\n        await this._client.send('Page.addScriptToEvaluateOnNewDocument', {\n            source: expression,\n        });\n        await Promise.all(this.frames().map((frame) => frame.evaluate(expression).catch(helper_js_1.debugError)));\n        function addPageBinding(bindingName) {\n            /* Cast window to any here as we're about to add properties to it\n             * via win[bindingName] which TypeScript doesn't like.\n             */\n            const win = window;\n            const binding = win[bindingName];\n            win[bindingName] = (...args) => {\n                const me = window[bindingName];\n                let callbacks = me['callbacks'];\n                if (!callbacks) {\n                    callbacks = new Map();\n                    me['callbacks'] = callbacks;\n                }\n                const seq = (me['lastSeq'] || 0) + 1;\n                me['lastSeq'] = seq;\n                const promise = new Promise((resolve, reject) => callbacks.set(seq, { resolve, reject }));\n                binding(JSON.stringify({ name: bindingName, seq, args }));\n                return promise;\n            };\n        }\n    }\n    async authenticate(credentials) {\n        return this._frameManager.networkManager().authenticate(credentials);\n    }\n    async setExtraHTTPHeaders(headers) {\n        return this._frameManager.networkManager().setExtraHTTPHeaders(headers);\n    }\n    async setUserAgent(userAgent) {\n        return this._frameManager.networkManager().setUserAgent(userAgent);\n    }\n    async metrics() {\n        const response = await this._client.send('Performance.getMetrics');\n        return this._buildMetricsObject(response.metrics);\n    }\n    _emitMetrics(event) {\n        this.emit(\"metrics\" /* Metrics */, {\n            title: event.title,\n            metrics: this._buildMetricsObject(event.metrics),\n        });\n    }\n    _buildMetricsObject(metrics) {\n        const result = {};\n        for (const metric of metrics || []) {\n            if (supportedMetrics.has(metric.name))\n                result[metric.name] = metric.value;\n        }\n        return result;\n    }\n    _handleException(exceptionDetails) {\n        const message = helper_js_1.helper.getExceptionMessage(exceptionDetails);\n        const err = new Error(message);\n        err.stack = ''; // Don't report clientside error with a node stack attached\n        this.emit(\"pageerror\" /* PageError */, err);\n    }\n    async _onConsoleAPI(event) {\n        if (event.executionContextId === 0) {\n            // DevTools protocol stores the last 1000 console messages. These\n            // messages are always reported even for removed execution contexts. In\n            // this case, they are marked with executionContextId = 0 and are\n            // reported upon enabling Runtime agent.\n            //\n            // Ignore these messages since:\n            // - there's no execution context we can use to operate with message\n            //   arguments\n            // - these messages are reported before Puppeteer clients can subscribe\n            //   to the 'console'\n            //   page event.\n            //\n            // @see https://github.com/puppeteer/puppeteer/issues/3865\n            return;\n        }\n        const context = this._frameManager.executionContextById(event.executionContextId);\n        const values = event.args.map((arg) => JSHandle_js_1.createJSHandle(context, arg));\n        this._addConsoleMessage(event.type, values, event.stackTrace);\n    }\n    async _onBindingCalled(event) {\n        const { name, seq, args } = JSON.parse(event.payload);\n        let expression = null;\n        try {\n            const result = await this._pageBindings.get(name)(...args);\n            expression = helper_js_1.helper.evaluationString(deliverResult, name, seq, result);\n        }\n        catch (error) {\n            if (error instanceof Error)\n                expression = helper_js_1.helper.evaluationString(deliverError, name, seq, error.message, error.stack);\n            else\n                expression = helper_js_1.helper.evaluationString(deliverErrorValue, name, seq, error);\n        }\n        this._client\n            .send('Runtime.evaluate', {\n            expression,\n            contextId: event.executionContextId,\n        })\n            .catch(helper_js_1.debugError);\n        function deliverResult(name, seq, result) {\n            window[name]['callbacks'].get(seq).resolve(result);\n            window[name]['callbacks'].delete(seq);\n        }\n        function deliverError(name, seq, message, stack) {\n            const error = new Error(message);\n            error.stack = stack;\n            window[name]['callbacks'].get(seq).reject(error);\n            window[name]['callbacks'].delete(seq);\n        }\n        function deliverErrorValue(name, seq, value) {\n            window[name]['callbacks'].get(seq).reject(value);\n            window[name]['callbacks'].delete(seq);\n        }\n    }\n    _addConsoleMessage(type, args, stackTrace) {\n        if (!this.listenerCount(\"console\" /* Console */)) {\n            args.forEach((arg) => arg.dispose());\n            return;\n        }\n        const textTokens = [];\n        for (const arg of args) {\n            const remoteObject = arg._remoteObject;\n            if (remoteObject.objectId)\n                textTokens.push(arg.toString());\n            else\n                textTokens.push(helper_js_1.helper.valueFromRemoteObject(remoteObject));\n        }\n        const location = stackTrace && stackTrace.callFrames.length\n            ? {\n                url: stackTrace.callFrames[0].url,\n                lineNumber: stackTrace.callFrames[0].lineNumber,\n                columnNumber: stackTrace.callFrames[0].columnNumber,\n            }\n            : {};\n        const message = new ConsoleMessage_js_1.ConsoleMessage(type, textTokens.join(' '), args, location);\n        this.emit(\"console\" /* Console */, message);\n    }\n    _onDialog(event) {\n        let dialogType = null;\n        const validDialogTypes = new Set([\n            'alert',\n            'confirm',\n            'prompt',\n            'beforeunload',\n        ]);\n        if (validDialogTypes.has(event.type)) {\n            dialogType = event.type;\n        }\n        assert_js_1.assert(dialogType, 'Unknown javascript dialog type: ' + event.type);\n        const dialog = new Dialog_js_1.Dialog(this._client, dialogType, event.message, event.defaultPrompt);\n        this.emit(\"dialog\" /* Dialog */, dialog);\n    }\n    url() {\n        return this.mainFrame().url();\n    }\n    async content() {\n        return await this._frameManager.mainFrame().content();\n    }\n    async setContent(html, options = {}) {\n        await this._frameManager.mainFrame().setContent(html, options);\n    }\n    async goto(url, options = {}) {\n        return await this._frameManager.mainFrame().goto(url, options);\n    }\n    async reload(options) {\n        const result = await Promise.all([\n            this.waitForNavigation(options),\n            this._client.send('Page.reload'),\n        ]);\n        return result[0];\n    }\n    async waitForNavigation(options = {}) {\n        return await this._frameManager.mainFrame().waitForNavigation(options);\n    }\n    _sessionClosePromise() {\n        if (!this._disconnectPromise)\n            this._disconnectPromise = new Promise((fulfill) => this._client.once(Connection_js_1.CDPSessionEmittedEvents.Disconnected, () => fulfill(new Error('Target closed'))));\n        return this._disconnectPromise;\n    }\n    async waitForRequest(urlOrPredicate, options = {}) {\n        const { timeout = this._timeoutSettings.timeout() } = options;\n        return helper_js_1.helper.waitForEvent(this._frameManager.networkManager(), NetworkManager_js_1.NetworkManagerEmittedEvents.Request, (request) => {\n            if (helper_js_1.helper.isString(urlOrPredicate))\n                return urlOrPredicate === request.url();\n            if (typeof urlOrPredicate === 'function')\n                return !!urlOrPredicate(request);\n            return false;\n        }, timeout, this._sessionClosePromise());\n    }\n    async waitForResponse(urlOrPredicate, options = {}) {\n        const { timeout = this._timeoutSettings.timeout() } = options;\n        return helper_js_1.helper.waitForEvent(this._frameManager.networkManager(), NetworkManager_js_1.NetworkManagerEmittedEvents.Response, (response) => {\n            if (helper_js_1.helper.isString(urlOrPredicate))\n                return urlOrPredicate === response.url();\n            if (typeof urlOrPredicate === 'function')\n                return !!urlOrPredicate(response);\n            return false;\n        }, timeout, this._sessionClosePromise());\n    }\n    async goBack(options = {}) {\n        return this._go(-1, options);\n    }\n    async goForward(options = {}) {\n        return this._go(+1, options);\n    }\n    async _go(delta, options) {\n        const history = await this._client.send('Page.getNavigationHistory');\n        const entry = history.entries[history.currentIndex + delta];\n        if (!entry)\n            return null;\n        const result = await Promise.all([\n            this.waitForNavigation(options),\n            this._client.send('Page.navigateToHistoryEntry', { entryId: entry.id }),\n        ]);\n        return result[0];\n    }\n    async bringToFront() {\n        await this._client.send('Page.bringToFront');\n    }\n    async emulate(options) {\n        await Promise.all([\n            this.setViewport(options.viewport),\n            this.setUserAgent(options.userAgent),\n        ]);\n    }\n    async setJavaScriptEnabled(enabled) {\n        if (this._javascriptEnabled === enabled)\n            return;\n        this._javascriptEnabled = enabled;\n        await this._client.send('Emulation.setScriptExecutionDisabled', {\n            value: !enabled,\n        });\n    }\n    async setBypassCSP(enabled) {\n        await this._client.send('Page.setBypassCSP', { enabled });\n    }\n    async emulateMediaType(type) {\n        assert_js_1.assert(type === 'screen' || type === 'print' || type === null, 'Unsupported media type: ' + type);\n        await this._client.send('Emulation.setEmulatedMedia', {\n            media: type || '',\n        });\n    }\n    async emulateMediaFeatures(features) {\n        if (features === null)\n            await this._client.send('Emulation.setEmulatedMedia', { features: null });\n        if (Array.isArray(features)) {\n            features.every((mediaFeature) => {\n                const name = mediaFeature.name;\n                assert_js_1.assert(/^prefers-(?:color-scheme|reduced-motion)$/.test(name), 'Unsupported media feature: ' + name);\n                return true;\n            });\n            await this._client.send('Emulation.setEmulatedMedia', {\n                features: features,\n            });\n        }\n    }\n    async emulateTimezone(timezoneId) {\n        try {\n            await this._client.send('Emulation.setTimezoneOverride', {\n                timezoneId: timezoneId || '',\n            });\n        }\n        catch (error) {\n            if (error.message.includes('Invalid timezone'))\n                throw new Error(`Invalid timezone ID: ${timezoneId}`);\n            throw error;\n        }\n    }\n    /**\n     * Simulates the given vision deficiency on the page.\n     *\n     * @example\n     * ```js\n     * const puppeteer = require('puppeteer');\n     *\n     * (async () => {\n     *   const browser = await puppeteer.launch();\n     *   const page = await browser.newPage();\n     *   await page.goto('https://v8.dev/blog/10-years');\n     *\n     *   await page.emulateVisionDeficiency('achromatopsia');\n     *   await page.screenshot({ path: 'achromatopsia.png' });\n     *\n     *   await page.emulateVisionDeficiency('deuteranopia');\n     *   await page.screenshot({ path: 'deuteranopia.png' });\n     *\n     *   await page.emulateVisionDeficiency('blurredVision');\n     *   await page.screenshot({ path: 'blurred-vision.png' });\n     *\n     *   await browser.close();\n     * })();\n     * ```\n     *\n     * @param type - the type of deficiency to simulate, or `'none'` to reset.\n     */\n    async emulateVisionDeficiency(type) {\n        const visionDeficiencies = new Set([\n            'none',\n            'achromatopsia',\n            'blurredVision',\n            'deuteranopia',\n            'protanopia',\n            'tritanopia',\n        ]);\n        try {\n            assert_js_1.assert(!type || visionDeficiencies.has(type), `Unsupported vision deficiency: ${type}`);\n            await this._client.send('Emulation.setEmulatedVisionDeficiency', {\n                type: type || 'none',\n            });\n        }\n        catch (error) {\n            throw error;\n        }\n    }\n    async setViewport(viewport) {\n        const needsReload = await this._emulationManager.emulateViewport(viewport);\n        this._viewport = viewport;\n        if (needsReload)\n            await this.reload();\n    }\n    viewport() {\n        return this._viewport;\n    }\n    /**\n     * @remarks\n     *\n     * Evaluates a function in the page's context and returns the result.\n     *\n     * If the function passed to `page.evaluteHandle` returns a Promise, the\n     * function will wait for the promise to resolve and return its value.\n     *\n     * @example\n     *\n     * ```js\n     * const result = await frame.evaluate(() => {\n     *   return Promise.resolve(8 * 7);\n     * });\n     * console.log(result); // prints \"56\"\n     * ```\n     *\n     * You can pass a string instead of a function (although functions are\n     * recommended as they are easier to debug and use with TypeScript):\n     *\n     * @example\n     * ```\n     * const aHandle = await page.evaluate('1 + 2');\n     * ```\n     *\n     * To get the best TypeScript experience, you should pass in as the\n     * generic the type of `pageFunction`:\n     *\n     * ```\n     * const aHandle = await page.evaluate<() => number>(() => 2);\n     * ```\n     *\n     * @example\n     *\n     * {@link ElementHandle} instances (including {@link JSHandle}s) can be passed\n     * as arguments to the `pageFunction`:\n     *\n     * ```\n     * const bodyHandle = await page.$('body');\n     * const html = await page.evaluate(body => body.innerHTML, bodyHandle);\n     * await bodyHandle.dispose();\n     * ```\n     *\n     * @param pageFunction - a function that is run within the page\n     * @param args - arguments to be passed to the pageFunction\n     *\n     * @returns the return value of `pageFunction`.\n     */\n    async evaluate(pageFunction, ...args) {\n        return this._frameManager.mainFrame().evaluate(pageFunction, ...args);\n    }\n    async evaluateOnNewDocument(pageFunction, ...args) {\n        const source = helper_js_1.helper.evaluationString(pageFunction, ...args);\n        await this._client.send('Page.addScriptToEvaluateOnNewDocument', {\n            source,\n        });\n    }\n    async setCacheEnabled(enabled = true) {\n        await this._frameManager.networkManager().setCacheEnabled(enabled);\n    }\n    async screenshot(options = {}) {\n        let screenshotType = null;\n        // options.type takes precedence over inferring the type from options.path\n        // because it may be a 0-length file with no extension created beforehand\n        // (i.e. as a temp file).\n        if (options.type) {\n            assert_js_1.assert(options.type === 'png' || options.type === 'jpeg', 'Unknown options.type value: ' + options.type);\n            screenshotType = options.type;\n        }\n        else if (options.path) {\n            const mimeType = mime.getType(options.path);\n            if (mimeType === 'image/png')\n                screenshotType = 'png';\n            else if (mimeType === 'image/jpeg')\n                screenshotType = 'jpeg';\n            assert_js_1.assert(screenshotType, 'Unsupported screenshot mime type: ' + mimeType);\n        }\n        if (!screenshotType)\n            screenshotType = 'png';\n        if (options.quality) {\n            assert_js_1.assert(screenshotType === 'jpeg', 'options.quality is unsupported for the ' +\n                screenshotType +\n                ' screenshots');\n            assert_js_1.assert(typeof options.quality === 'number', 'Expected options.quality to be a number but found ' +\n                typeof options.quality);\n            assert_js_1.assert(Number.isInteger(options.quality), 'Expected options.quality to be an integer');\n            assert_js_1.assert(options.quality >= 0 && options.quality <= 100, 'Expected options.quality to be between 0 and 100 (inclusive), got ' +\n                options.quality);\n        }\n        assert_js_1.assert(!options.clip || !options.fullPage, 'options.clip and options.fullPage are exclusive');\n        if (options.clip) {\n            assert_js_1.assert(typeof options.clip.x === 'number', 'Expected options.clip.x to be a number but found ' +\n                typeof options.clip.x);\n            assert_js_1.assert(typeof options.clip.y === 'number', 'Expected options.clip.y to be a number but found ' +\n                typeof options.clip.y);\n            assert_js_1.assert(typeof options.clip.width === 'number', 'Expected options.clip.width to be a number but found ' +\n                typeof options.clip.width);\n            assert_js_1.assert(typeof options.clip.height === 'number', 'Expected options.clip.height to be a number but found ' +\n                typeof options.clip.height);\n            assert_js_1.assert(options.clip.width !== 0, 'Expected options.clip.width not to be 0.');\n            assert_js_1.assert(options.clip.height !== 0, 'Expected options.clip.height not to be 0.');\n        }\n        return this._screenshotTaskQueue.postTask(() => this._screenshotTask(screenshotType, options));\n    }\n    async _screenshotTask(format, options) {\n        await this._client.send('Target.activateTarget', {\n            targetId: this._target._targetId,\n        });\n        let clip = options.clip ? processClip(options.clip) : undefined;\n        if (options.fullPage) {\n            const metrics = await this._client.send('Page.getLayoutMetrics');\n            const width = Math.ceil(metrics.contentSize.width);\n            const height = Math.ceil(metrics.contentSize.height);\n            // Overwrite clip for full page at all times.\n            clip = { x: 0, y: 0, width, height, scale: 1 };\n            const { isMobile = false, deviceScaleFactor = 1, isLandscape = false } = this._viewport || {};\n            const screenOrientation = isLandscape\n                ? { angle: 90, type: 'landscapePrimary' }\n                : { angle: 0, type: 'portraitPrimary' };\n            await this._client.send('Emulation.setDeviceMetricsOverride', {\n                mobile: isMobile,\n                width,\n                height,\n                deviceScaleFactor,\n                screenOrientation,\n            });\n        }\n        const shouldSetDefaultBackground = options.omitBackground && format === 'png';\n        if (shouldSetDefaultBackground)\n            await this._client.send('Emulation.setDefaultBackgroundColorOverride', {\n                color: { r: 0, g: 0, b: 0, a: 0 },\n            });\n        const result = await this._client.send('Page.captureScreenshot', {\n            format,\n            quality: options.quality,\n            clip,\n        });\n        if (shouldSetDefaultBackground)\n            await this._client.send('Emulation.setDefaultBackgroundColorOverride');\n        if (options.fullPage && this._viewport)\n            await this.setViewport(this._viewport);\n        const buffer = options.encoding === 'base64'\n            ? result.data\n            : Buffer.from(result.data, 'base64');\n        if (options.path)\n            await writeFileAsync(options.path, buffer);\n        return buffer;\n        function processClip(clip) {\n            const x = Math.round(clip.x);\n            const y = Math.round(clip.y);\n            const width = Math.round(clip.width + clip.x - x);\n            const height = Math.round(clip.height + clip.y - y);\n            return { x, y, width, height, scale: 1 };\n        }\n    }\n    /**\n     * Generatees a PDF of the page with the `print` CSS media type.\n     * @remarks\n     *\n     * IMPORTANT: PDF generation is only supported in Chrome headless mode.\n     *\n     * To generate a PDF with the `screen` media type, call\n     * {@link Page.emulateMediaType | `page.emulateMediaType('screen')`} before\n     * calling `page.pdf()`.\n     *\n     * By default, `page.pdf()` generates a pdf with modified colors for printing.\n     * Use the\n     * {@link https://developer.mozilla.org/en-US/docs/Web/CSS/-webkit-print-color-adjust | `-webkit-print-color-adjust`}\n     * property to force rendering of exact colors.\n     *\n     *\n     * @param options - options for generating the PDF.\n     */\n    async pdf(options = {}) {\n        const { scale = 1, displayHeaderFooter = false, headerTemplate = '', footerTemplate = '', printBackground = false, landscape = false, pageRanges = '', preferCSSPageSize = false, margin = {}, path = null, } = options;\n        let paperWidth = 8.5;\n        let paperHeight = 11;\n        if (options.format) {\n            const format = PDFOptions_js_1.paperFormats[options.format.toLowerCase()];\n            assert_js_1.assert(format, 'Unknown paper format: ' + options.format);\n            paperWidth = format.width;\n            paperHeight = format.height;\n        }\n        else {\n            paperWidth = convertPrintParameterToInches(options.width) || paperWidth;\n            paperHeight =\n                convertPrintParameterToInches(options.height) || paperHeight;\n        }\n        const marginTop = convertPrintParameterToInches(margin.top) || 0;\n        const marginLeft = convertPrintParameterToInches(margin.left) || 0;\n        const marginBottom = convertPrintParameterToInches(margin.bottom) || 0;\n        const marginRight = convertPrintParameterToInches(margin.right) || 0;\n        const result = await this._client.send('Page.printToPDF', {\n            transferMode: 'ReturnAsStream',\n            landscape,\n            displayHeaderFooter,\n            headerTemplate,\n            footerTemplate,\n            printBackground,\n            scale,\n            paperWidth,\n            paperHeight,\n            marginTop,\n            marginBottom,\n            marginLeft,\n            marginRight,\n            pageRanges,\n            preferCSSPageSize,\n        });\n        return await helper_js_1.helper.readProtocolStream(this._client, result.stream, path);\n    }\n    async title() {\n        return this.mainFrame().title();\n    }\n    async close(options = { runBeforeUnload: undefined }) {\n        assert_js_1.assert(!!this._client._connection, 'Protocol error: Connection closed. Most likely the page has been closed.');\n        const runBeforeUnload = !!options.runBeforeUnload;\n        if (runBeforeUnload) {\n            await this._client.send('Page.close');\n        }\n        else {\n            await this._client._connection.send('Target.closeTarget', {\n                targetId: this._target._targetId,\n            });\n            await this._target._isClosedPromise;\n        }\n    }\n    isClosed() {\n        return this._closed;\n    }\n    get mouse() {\n        return this._mouse;\n    }\n    click(selector, options = {}) {\n        return this.mainFrame().click(selector, options);\n    }\n    focus(selector) {\n        return this.mainFrame().focus(selector);\n    }\n    hover(selector) {\n        return this.mainFrame().hover(selector);\n    }\n    select(selector, ...values) {\n        return this.mainFrame().select(selector, ...values);\n    }\n    tap(selector) {\n        return this.mainFrame().tap(selector);\n    }\n    type(selector, text, options) {\n        return this.mainFrame().type(selector, text, options);\n    }\n    /**\n     * @remarks\n     *\n     * This method behaves differently depending on the first parameter. If it's a\n     * `string`, it will be treated as a `selector` or `xpath` (if the string\n     * starts with `//`). This method then is a shortcut for\n     * {@link Page.waitForSelector} or {@link Page.waitForXPath}.\n     *\n     * If the first argument is a function this method is a shortcut for\n     * {@link Page.waitForFunction}.\n     *\n     * If the first argument is a `number`, it's treated as a timeout in\n     * milliseconds and the method returns a promise which resolves after the\n     * timeout.\n     *\n     * @param selectorOrFunctionOrTimeout - a selector, predicate or timeout to\n     * wait for.\n     * @param options - optional waiting parameters.\n     * @param args - arguments to pass to `pageFunction`.\n     *\n     * @deprecated Don't use this method directly. Instead use the more explicit\n     * methods available: {@link Page.waitForSelector},\n     * {@link Page.waitForXPath}, {@link Page.waitForFunction} or\n     * {@link Page.waitForTimeout}.\n     */\n    waitFor(selectorOrFunctionOrTimeout, options = {}, ...args) {\n        return this.mainFrame().waitFor(selectorOrFunctionOrTimeout, options, ...args);\n    }\n    /**\n     * Causes your script to wait for the given number of milliseconds.\n     *\n     * @remarks\n     *\n     * It's generally recommended to not wait for a number of seconds, but instead\n     * use {@link Page.waitForSelector}, {@link Page.waitForXPath} or\n     * {@link Page.waitForFunction} to wait for exactly the conditions you want.\n     *\n     * @example\n     *\n     * Wait for 1 second:\n     *\n     * ```\n     * await page.waitForTimeout(1000);\n     * ```\n     *\n     * @param milliseconds - the number of milliseconds to wait.\n     */\n    waitForTimeout(milliseconds) {\n        return this.mainFrame().waitForTimeout(milliseconds);\n    }\n    waitForSelector(selector, options = {}) {\n        return this.mainFrame().waitForSelector(selector, options);\n    }\n    waitForXPath(xpath, options = {}) {\n        return this.mainFrame().waitForXPath(xpath, options);\n    }\n    waitForFunction(pageFunction, options = {}, ...args) {\n        return this.mainFrame().waitForFunction(pageFunction, options, ...args);\n    }\n}\nexports.Page = Page;\nconst supportedMetrics = new Set([\n    'Timestamp',\n    'Documents',\n    'Frames',\n    'JSEventListeners',\n    'Nodes',\n    'LayoutCount',\n    'RecalcStyleCount',\n    'LayoutDuration',\n    'RecalcStyleDuration',\n    'ScriptDuration',\n    'TaskDuration',\n    'JSHeapUsedSize',\n    'JSHeapTotalSize',\n]);\nconst unitToPixels = {\n    px: 1,\n    in: 96,\n    cm: 37.8,\n    mm: 3.78,\n};\nfunction convertPrintParameterToInches(parameter) {\n    if (typeof parameter === 'undefined')\n        return undefined;\n    let pixels;\n    if (helper_js_1.helper.isNumber(parameter)) {\n        // Treat numbers as pixel values to be aligned with phantom's paperSize.\n        pixels = /** @type {number} */ parameter;\n    }\n    else if (helper_js_1.helper.isString(parameter)) {\n        const text = /** @type {string} */ parameter;\n        let unit = text.substring(text.length - 2).toLowerCase();\n        let valueText = '';\n        if (unitToPixels.hasOwnProperty(unit)) {\n            valueText = text.substring(0, text.length - 2);\n        }\n        else {\n            // In case of unknown unit try to parse the whole parameter as number of pixels.\n            // This is consistent with phantom's paperSize behavior.\n            unit = 'px';\n            valueText = text;\n        }\n        const value = Number(valueText);\n        assert_js_1.assert(!isNaN(value), 'Failed to parse parameter value: ' + text);\n        pixels = value * unitToPixels[unit];\n    }\n    else {\n        throw new Error('page.pdf() Cannot handle parameter type: ' + typeof parameter);\n    }\n    return pixels / 96;\n}\n"]},"metadata":{},"sourceType":"script"}