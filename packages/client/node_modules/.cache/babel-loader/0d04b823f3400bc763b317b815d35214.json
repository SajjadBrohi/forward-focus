{"ast":null,"code":"module.exports = Pend;\n\nfunction Pend() {\n  this.pending = 0;\n  this.max = Infinity;\n  this.listeners = [];\n  this.waiting = [];\n  this.error = null;\n}\n\nPend.prototype.go = function (fn) {\n  if (this.pending < this.max) {\n    pendGo(this, fn);\n  } else {\n    this.waiting.push(fn);\n  }\n};\n\nPend.prototype.wait = function (cb) {\n  if (this.pending === 0) {\n    cb(this.error);\n  } else {\n    this.listeners.push(cb);\n  }\n};\n\nPend.prototype.hold = function () {\n  return pendHold(this);\n};\n\nfunction pendHold(self) {\n  self.pending += 1;\n  var called = false;\n  return onCb;\n\n  function onCb(err) {\n    if (called) throw new Error(\"callback called twice\");\n    called = true;\n    self.error = self.error || err;\n    self.pending -= 1;\n\n    if (self.waiting.length > 0 && self.pending < self.max) {\n      pendGo(self, self.waiting.shift());\n    } else if (self.pending === 0) {\n      var listeners = self.listeners;\n      self.listeners = [];\n      listeners.forEach(cbListener);\n    }\n  }\n\n  function cbListener(listener) {\n    listener(self.error);\n  }\n}\n\nfunction pendGo(self, fn) {\n  fn(pendHold(self));\n}","map":{"version":3,"sources":["C:/Users/Sajjad Brohi/JavaScript Projects/RESTful API/packages/client/node_modules/pend/index.js"],"names":["module","exports","Pend","pending","max","Infinity","listeners","waiting","error","prototype","go","fn","pendGo","push","wait","cb","hold","pendHold","self","called","onCb","err","Error","length","shift","forEach","cbListener","listener"],"mappings":"AAAAA,MAAM,CAACC,OAAP,GAAiBC,IAAjB;;AAEA,SAASA,IAAT,GAAgB;AACd,OAAKC,OAAL,GAAe,CAAf;AACA,OAAKC,GAAL,GAAWC,QAAX;AACA,OAAKC,SAAL,GAAiB,EAAjB;AACA,OAAKC,OAAL,GAAe,EAAf;AACA,OAAKC,KAAL,GAAa,IAAb;AACD;;AAEDN,IAAI,CAACO,SAAL,CAAeC,EAAf,GAAoB,UAASC,EAAT,EAAa;AAC/B,MAAI,KAAKR,OAAL,GAAe,KAAKC,GAAxB,EAA6B;AAC3BQ,IAAAA,MAAM,CAAC,IAAD,EAAOD,EAAP,CAAN;AACD,GAFD,MAEO;AACL,SAAKJ,OAAL,CAAaM,IAAb,CAAkBF,EAAlB;AACD;AACF,CAND;;AAQAT,IAAI,CAACO,SAAL,CAAeK,IAAf,GAAsB,UAASC,EAAT,EAAa;AACjC,MAAI,KAAKZ,OAAL,KAAiB,CAArB,EAAwB;AACtBY,IAAAA,EAAE,CAAC,KAAKP,KAAN,CAAF;AACD,GAFD,MAEO;AACL,SAAKF,SAAL,CAAeO,IAAf,CAAoBE,EAApB;AACD;AACF,CAND;;AAQAb,IAAI,CAACO,SAAL,CAAeO,IAAf,GAAsB,YAAW;AAC/B,SAAOC,QAAQ,CAAC,IAAD,CAAf;AACD,CAFD;;AAIA,SAASA,QAAT,CAAkBC,IAAlB,EAAwB;AACtBA,EAAAA,IAAI,CAACf,OAAL,IAAgB,CAAhB;AACA,MAAIgB,MAAM,GAAG,KAAb;AACA,SAAOC,IAAP;;AACA,WAASA,IAAT,CAAcC,GAAd,EAAmB;AACjB,QAAIF,MAAJ,EAAY,MAAM,IAAIG,KAAJ,CAAU,uBAAV,CAAN;AACZH,IAAAA,MAAM,GAAG,IAAT;AACAD,IAAAA,IAAI,CAACV,KAAL,GAAaU,IAAI,CAACV,KAAL,IAAca,GAA3B;AACAH,IAAAA,IAAI,CAACf,OAAL,IAAgB,CAAhB;;AACA,QAAIe,IAAI,CAACX,OAAL,CAAagB,MAAb,GAAsB,CAAtB,IAA2BL,IAAI,CAACf,OAAL,GAAee,IAAI,CAACd,GAAnD,EAAwD;AACtDQ,MAAAA,MAAM,CAACM,IAAD,EAAOA,IAAI,CAACX,OAAL,CAAaiB,KAAb,EAAP,CAAN;AACD,KAFD,MAEO,IAAIN,IAAI,CAACf,OAAL,KAAiB,CAArB,EAAwB;AAC7B,UAAIG,SAAS,GAAGY,IAAI,CAACZ,SAArB;AACAY,MAAAA,IAAI,CAACZ,SAAL,GAAiB,EAAjB;AACAA,MAAAA,SAAS,CAACmB,OAAV,CAAkBC,UAAlB;AACD;AACF;;AACD,WAASA,UAAT,CAAoBC,QAApB,EAA8B;AAC5BA,IAAAA,QAAQ,CAACT,IAAI,CAACV,KAAN,CAAR;AACD;AACF;;AAED,SAASI,MAAT,CAAgBM,IAAhB,EAAsBP,EAAtB,EAA0B;AACxBA,EAAAA,EAAE,CAACM,QAAQ,CAACC,IAAD,CAAT,CAAF;AACD","sourcesContent":["module.exports = Pend;\n\nfunction Pend() {\n  this.pending = 0;\n  this.max = Infinity;\n  this.listeners = [];\n  this.waiting = [];\n  this.error = null;\n}\n\nPend.prototype.go = function(fn) {\n  if (this.pending < this.max) {\n    pendGo(this, fn);\n  } else {\n    this.waiting.push(fn);\n  }\n};\n\nPend.prototype.wait = function(cb) {\n  if (this.pending === 0) {\n    cb(this.error);\n  } else {\n    this.listeners.push(cb);\n  }\n};\n\nPend.prototype.hold = function() {\n  return pendHold(this);\n};\n\nfunction pendHold(self) {\n  self.pending += 1;\n  var called = false;\n  return onCb;\n  function onCb(err) {\n    if (called) throw new Error(\"callback called twice\");\n    called = true;\n    self.error = self.error || err;\n    self.pending -= 1;\n    if (self.waiting.length > 0 && self.pending < self.max) {\n      pendGo(self, self.waiting.shift());\n    } else if (self.pending === 0) {\n      var listeners = self.listeners;\n      self.listeners = [];\n      listeners.forEach(cbListener);\n    }\n  }\n  function cbListener(listener) {\n    listener(self.error);\n  }\n}\n\nfunction pendGo(self, fn) {\n  fn(pendHold(self));\n}\n"]},"metadata":{},"sourceType":"script"}